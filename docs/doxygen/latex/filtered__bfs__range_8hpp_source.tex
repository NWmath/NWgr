\hypertarget{filtered__bfs__range_8hpp_source}{}\doxysection{filtered\+\_\+bfs\+\_\+range.\+hpp}
\label{filtered__bfs__range_8hpp_source}\index{/Users/lums/NWmath/NWgr/include/nwgraph/adaptors/filtered\_bfs\_range.hpp@{/Users/lums/NWmath/NWgr/include/nwgraph/adaptors/filtered\_bfs\_range.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// }}
\DoxyCodeLine{2 \textcolor{comment}{// This file is part of NW Graph (aka GraphPack) }}
\DoxyCodeLine{3 \textcolor{comment}{// (c) Pacific Northwest National Laboratory 2018-\/2021 }}
\DoxyCodeLine{4 \textcolor{comment}{// (c) University of Washington 2018-\/2021 }}
\DoxyCodeLine{5 \textcolor{comment}{// }}
\DoxyCodeLine{6 \textcolor{comment}{// Licensed under terms of include LICENSE file }}
\DoxyCodeLine{7 \textcolor{comment}{// }}
\DoxyCodeLine{8 \textcolor{comment}{// Authors: }}
\DoxyCodeLine{9 \textcolor{comment}{//     Andrew Lumsdaine }}
\DoxyCodeLine{10 \textcolor{comment}{//     Kevin Deweese    }}
\DoxyCodeLine{11 \textcolor{comment}{//}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#ifndef NW\_GRAPH\_FILTERED\_BFS\_RANGE\_HPP}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#define NW\_GRAPH\_FILTERED\_BFS\_RANGE\_HPP}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include "{}nwgraph/graph\_traits.hpp"{}}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include "{}nwgraph/util/util.hpp"{}}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <cassert>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <functional>}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <queue>}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <tuple>}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{keyword}{namespace }nw \{}
\DoxyCodeLine{25 \textcolor{keyword}{namespace }graph \{}
\DoxyCodeLine{26 \textcolor{keyword}{namespace }filtered\_bfs \{}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{keyword}{enum} three\_colors \{ black, white, grey \};}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Graph, \textcolor{keyword}{typename} Queue = std::queue<vertex\_\textcolor{keywordtype}{id}\_t<Graph>>, \textcolor{keyword}{typename} Filter = std::function<\textcolor{keywordtype}{bool}()>>}
\DoxyCodeLine{31 \textcolor{keyword}{class }\mbox{\hyperlink{classnw_1_1graph_1_1filtered__bfs_1_1filtered__bfs__edge__range}{filtered\_bfs\_edge\_range}} \{}
\DoxyCodeLine{32 }
\DoxyCodeLine{33 \textcolor{keyword}{public}:}
\DoxyCodeLine{34   \textcolor{keyword}{using} vertex\_id\_type = vertex\_id\_t<Graph>;}
\DoxyCodeLine{35 }
\DoxyCodeLine{36   \mbox{\hyperlink{classnw_1_1graph_1_1filtered__bfs_1_1filtered__bfs__edge__range}{filtered\_bfs\_edge\_range}}(}
\DoxyCodeLine{37       Graph\& graph, vertex\_id\_type source, vertex\_id\_type target,}
\DoxyCodeLine{38       Filter filter = [](vertex\_id\_type v, \textcolor{keyword}{typename} Graph::inner\_iterator iter) \{ \textcolor{keywordflow}{return} \textcolor{keyword}{false}; \})}
\DoxyCodeLine{39       : the\_graph\_(graph), colors\_(graph.end() -\/ graph.begin(), white), target\_(target), filter\_(filter) \{}
\DoxyCodeLine{40     Q\_.push(source);}
\DoxyCodeLine{41     colors\_[source] = grey;}
\DoxyCodeLine{42   \}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44   \mbox{\hyperlink{classnw_1_1graph_1_1filtered__bfs_1_1filtered__bfs__edge__range}{filtered\_bfs\_edge\_range}}(\textcolor{keyword}{const} \mbox{\hyperlink{classnw_1_1graph_1_1filtered__bfs_1_1filtered__bfs__edge__range}{filtered\_bfs\_edge\_range}}\&)  = \textcolor{keyword}{delete};}
\DoxyCodeLine{45   \mbox{\hyperlink{classnw_1_1graph_1_1filtered__bfs_1_1filtered__bfs__edge__range}{filtered\_bfs\_edge\_range}}(\textcolor{keyword}{const} \mbox{\hyperlink{classnw_1_1graph_1_1filtered__bfs_1_1filtered__bfs__edge__range}{filtered\_bfs\_edge\_range}}\&\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{46 }
\DoxyCodeLine{47   \textcolor{keywordtype}{bool} empty() \{ \textcolor{keywordflow}{return} Q\_.empty(); \}}
\DoxyCodeLine{48   \textcolor{keywordtype}{bool} found() \{ \textcolor{keywordflow}{return} colors\_[target\_] == grey; \}}
\DoxyCodeLine{49   \textcolor{keywordtype}{bool} done() \{ \textcolor{keywordflow}{return} (found() || unreachable); \}}
\DoxyCodeLine{50   \textcolor{keywordtype}{bool} unreachable = \textcolor{keyword}{false};}
\DoxyCodeLine{51 }
\DoxyCodeLine{52   \textcolor{keyword}{class }\mbox{\hyperlink{classnw_1_1graph_1_1filtered__bfs_1_1filtered__bfs__edge__range_1_1filtered__bfs__edge__range__iterator}{filtered\_bfs\_edge\_range\_iterator}} \{}
\DoxyCodeLine{53 }
\DoxyCodeLine{54   \textcolor{keyword}{public}:}
\DoxyCodeLine{55     \mbox{\hyperlink{classnw_1_1graph_1_1filtered__bfs_1_1filtered__bfs__edge__range_1_1filtered__bfs__edge__range__iterator}{filtered\_bfs\_edge\_range\_iterator}}(\mbox{\hyperlink{classnw_1_1graph_1_1filtered__bfs_1_1filtered__bfs__edge__range}{filtered\_bfs\_edge\_range<Graph, Queue, Filter>}}\& range)}
\DoxyCodeLine{56         : the\_range\_(range), G(the\_range\_.the\_graph\_.begin()), v\_(the\_range\_.Q\_.front()), u\_begin(G[v\_].begin()),}
\DoxyCodeLine{57           iterator\_target\_(the\_range\_.target\_), filter\_(the\_range\_.filter\_) \{}
\DoxyCodeLine{58 }
\DoxyCodeLine{59       \textcolor{keywordflow}{while} (filter\_(v\_, u\_begin)) \{}
\DoxyCodeLine{60         ++u\_begin;}
\DoxyCodeLine{61         \textcolor{keywordflow}{if} (u\_begin == G[v\_].end()) \{}
\DoxyCodeLine{62           the\_range\_.unreachable = \textcolor{keyword}{true};}
\DoxyCodeLine{63           \textcolor{keywordflow}{break};}
\DoxyCodeLine{64         \}}
\DoxyCodeLine{65       \}}
\DoxyCodeLine{66     \}}
\DoxyCodeLine{67 }
\DoxyCodeLine{68     \mbox{\hyperlink{classnw_1_1graph_1_1filtered__bfs_1_1filtered__bfs__edge__range_1_1filtered__bfs__edge__range__iterator}{filtered\_bfs\_edge\_range\_iterator}}(\textcolor{keyword}{const} \mbox{\hyperlink{classnw_1_1graph_1_1filtered__bfs_1_1filtered__bfs__edge__range_1_1filtered__bfs__edge__range__iterator}{filtered\_bfs\_edge\_range\_iterator}}\& ite)}
\DoxyCodeLine{69         : the\_range\_(ite.the\_range\_), G(ite.G), v\_(ite.v\_), u\_begin(u\_begin), filter\_(ite.filter\_) \{\}}
\DoxyCodeLine{70 }
\DoxyCodeLine{71     \mbox{\hyperlink{classnw_1_1graph_1_1filtered__bfs_1_1filtered__bfs__edge__range_1_1filtered__bfs__edge__range__iterator}{filtered\_bfs\_edge\_range\_iterator}}\& operator++() \{}
\DoxyCodeLine{72       \textcolor{keyword}{auto}\& Q      = the\_range\_.Q\_;}
\DoxyCodeLine{73       \textcolor{keyword}{auto}\& colors = the\_range\_.colors\_;}
\DoxyCodeLine{74 }
\DoxyCodeLine{75       Q.push(std::get<0>(*u\_begin));}
\DoxyCodeLine{76       colors[std::get<0>(*u\_begin)] = grey;}
\DoxyCodeLine{77 }
\DoxyCodeLine{78       \textcolor{keywordflow}{if} (iterator\_target\_ == std::get<0>(*u\_begin)) \{}
\DoxyCodeLine{79         colors[std::get<0>(*u\_begin)] = grey;}
\DoxyCodeLine{80         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{81       \}}
\DoxyCodeLine{82       ++u\_begin;}
\DoxyCodeLine{83 }
\DoxyCodeLine{84       \textcolor{keywordflow}{while} (u\_begin != G[v\_].end()) \{}
\DoxyCodeLine{85         \textcolor{keywordflow}{if} (colors[std::get<0>(*u\_begin)] == white \&\& !filter\_(v\_, u\_begin)) \textcolor{keywordflow}{break};}
\DoxyCodeLine{86 }
\DoxyCodeLine{87         ++u\_begin;}
\DoxyCodeLine{88       \}}
\DoxyCodeLine{89 }
\DoxyCodeLine{90       \textcolor{keywordflow}{while} (u\_begin == G[v\_].end()) \{}
\DoxyCodeLine{91         colors[v\_] = black;}
\DoxyCodeLine{92         Q.pop();}
\DoxyCodeLine{93         \textcolor{keywordflow}{if} (Q.empty()) \{}
\DoxyCodeLine{94           the\_range\_.unreachable = \textcolor{keyword}{true};}
\DoxyCodeLine{95           \textcolor{keywordflow}{break};}
\DoxyCodeLine{96         \}}
\DoxyCodeLine{97 }
\DoxyCodeLine{98         v\_ = Q.front();}
\DoxyCodeLine{99         assert(colors[v\_] == grey);}
\DoxyCodeLine{100 }
\DoxyCodeLine{101         u\_begin = G[v\_].begin();}
\DoxyCodeLine{102 }
\DoxyCodeLine{103         \textcolor{keywordflow}{while} (u\_begin != G[v\_].end()) \{}
\DoxyCodeLine{104           \textcolor{keywordflow}{if} (colors[std::get<0>(*u\_begin)] == white \&\& !filter\_(v\_, u\_begin)) \textcolor{keywordflow}{break};}
\DoxyCodeLine{105 }
\DoxyCodeLine{106           ++u\_begin;}
\DoxyCodeLine{107         \}}
\DoxyCodeLine{108       \}}
\DoxyCodeLine{109       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{110     \}}
\DoxyCodeLine{111 }
\DoxyCodeLine{112     \textcolor{keyword}{auto} operator*() \{ \textcolor{keywordflow}{return} *u\_begin; \}}
\DoxyCodeLine{113     \textcolor{keyword}{class }\mbox{\hyperlink{classnw_1_1graph_1_1filtered__bfs_1_1filtered__bfs__edge__range_1_1filtered__bfs__edge__range__iterator_1_1end__sentinel__type}{end\_sentinel\_type}} \{}
\DoxyCodeLine{114     \textcolor{keyword}{public}:}
\DoxyCodeLine{115       \mbox{\hyperlink{classnw_1_1graph_1_1filtered__bfs_1_1filtered__bfs__edge__range_1_1filtered__bfs__edge__range__iterator_1_1end__sentinel__type}{end\_sentinel\_type}}() \{\}}
\DoxyCodeLine{116     \};}
\DoxyCodeLine{117 }
\DoxyCodeLine{118     \textcolor{keyword}{auto} get\_index() \{ \textcolor{keywordflow}{return} v\_; \};}
\DoxyCodeLine{119 }
\DoxyCodeLine{120     \textcolor{keyword}{auto} operator==(\textcolor{keyword}{const} end\_sentinel\_type\&)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} the\_range\_.done(); \}}
\DoxyCodeLine{121     \textcolor{keywordtype}{bool} operator!=(\textcolor{keyword}{const} end\_sentinel\_type\&)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} !the\_range\_.done(); \}}
\DoxyCodeLine{122 }
\DoxyCodeLine{123     \textcolor{keywordtype}{bool} found() \{ \textcolor{keywordflow}{return} the\_range\_.found(); \}}
\DoxyCodeLine{124 }
\DoxyCodeLine{125   \textcolor{keyword}{private}:}
\DoxyCodeLine{126     filtered\_bfs\_edge\_range<Graph, Queue, Filter>\& the\_range\_;}
\DoxyCodeLine{127     \textcolor{keyword}{typename} Graph::outer\_iterator                 G;}
\DoxyCodeLine{128     vertex\_id\_type                                 v\_;}
\DoxyCodeLine{129     \textcolor{keyword}{typename} Graph::inner\_iterator                 u\_begin;}
\DoxyCodeLine{130     vertex\_id\_type                                 iterator\_target\_;}
\DoxyCodeLine{131     Filter                                         filter\_;}
\DoxyCodeLine{132   \};}
\DoxyCodeLine{133 }
\DoxyCodeLine{134   \textcolor{keyword}{typedef} filtered\_bfs\_edge\_range\_iterator iterator;}
\DoxyCodeLine{135 }
\DoxyCodeLine{136   \textcolor{keyword}{auto} begin() \{ \textcolor{keywordflow}{return} filtered\_bfs\_edge\_range\_iterator(*\textcolor{keyword}{this}); \}}
\DoxyCodeLine{137   \textcolor{keyword}{auto} end() \{ \textcolor{keywordflow}{return} \textcolor{keyword}{typename} filtered\_bfs\_edge\_range\_iterator::end\_sentinel\_type(); \}}
\DoxyCodeLine{138 }
\DoxyCodeLine{139 \textcolor{keyword}{private}:}
\DoxyCodeLine{140   Graph\&                    the\_graph\_;}
\DoxyCodeLine{141   Queue                     Q\_;}
\DoxyCodeLine{142   std::vector<three\_colors> colors\_;}
\DoxyCodeLine{143   vertex\_id\_type            target\_;}
\DoxyCodeLine{144   Filter                    filter\_;}
\DoxyCodeLine{145 \};}
\DoxyCodeLine{146 \}    \textcolor{comment}{// namespace filtered\_bfs}}
\DoxyCodeLine{147 \}    \textcolor{comment}{// namespace graph}}
\DoxyCodeLine{148 \}    \textcolor{comment}{// namespace nw}}
\DoxyCodeLine{149 \textcolor{preprocessor}{\#endif    }\textcolor{comment}{// NW\_GRAPH\_FILTERED\_BFS\_RANGE\_HPP}}

\end{DoxyCode}
