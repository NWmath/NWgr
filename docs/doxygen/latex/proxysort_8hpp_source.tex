\hypertarget{proxysort_8hpp_source}{}\doxysection{proxysort.\+hpp}
\label{proxysort_8hpp_source}\index{/Users/lums/NWmath/NWgr/include/nwgraph/util/proxysort.hpp@{/Users/lums/NWmath/NWgr/include/nwgraph/util/proxysort.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// }}
\DoxyCodeLine{2 \textcolor{comment}{// This file is part of NW Graph (aka GraphPack) }}
\DoxyCodeLine{3 \textcolor{comment}{// (c) Pacific Northwest National Laboratory 2018-\/2021 }}
\DoxyCodeLine{4 \textcolor{comment}{// (c) University of Washington 2018-\/2021 }}
\DoxyCodeLine{5 \textcolor{comment}{// }}
\DoxyCodeLine{6 \textcolor{comment}{// Licensed under terms of include LICENSE file }}
\DoxyCodeLine{7 \textcolor{comment}{// }}
\DoxyCodeLine{8 \textcolor{comment}{// Authors: }}
\DoxyCodeLine{9 \textcolor{comment}{//     Andrew Lumsdaine}}
\DoxyCodeLine{10 \textcolor{comment}{//     Kevin Deweese    }}
\DoxyCodeLine{11 \textcolor{comment}{//}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 }
\DoxyCodeLine{14 \textcolor{preprocessor}{\#ifndef NW\_UTIL\_PROXYSORT\_HPP}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#define NW\_UTIL\_PROXYSORT\_HPP}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <cassert>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <cstddef>}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <cstdint>}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <functional>}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <numeric>}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#include <execution>}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{keyword}{namespace }nw \{}
\DoxyCodeLine{27 \textcolor{keyword}{namespace }util \{}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{comment}{// template<typename ThingToSort, typename Comparator>}}
\DoxyCodeLine{30 \textcolor{comment}{// void proxysort(const ThingToSort\& x, std::vector<size\_t>\& perm) \{}}
\DoxyCodeLine{31 \textcolor{comment}{//   std::iota(perm.begin(), perm.end(), 0);}}
\DoxyCodeLine{32 \textcolor{comment}{//  std::sort(perm.begin(), perm.end(), [\&](auto a, auto b) \{ return x(a) > x(b); \});}}
\DoxyCodeLine{33 \textcolor{comment}{//\}}}
\DoxyCodeLine{34 }
\DoxyCodeLine{35 \textcolor{keyword}{template} <\textcolor{keyword}{typename} ThingToSort, \textcolor{keyword}{typename} Comparator, \textcolor{keyword}{typename} IntT, \textcolor{keyword}{class} ExecutionPolicy = std::execution::parallel\_unsequenced\_policy>}
\DoxyCodeLine{36 \textcolor{keywordtype}{void} proxysort(\textcolor{keyword}{const} ThingToSort\& x, std::vector<IntT>\& perm, Comparator comp = std::less<IntT>(), ExecutionPolicy policy = \{\}) \{}
\DoxyCodeLine{37   assert(perm.size() == x.size());}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{40   tbb::parallel\_for(tbb::blocked\_range(0ul, perm.size()), [\&](\textcolor{keyword}{auto}\&\& r) \{}
\DoxyCodeLine{41     for (auto i = r.begin(), e = r.end(); i != e; ++i) \{}
\DoxyCodeLine{42       perm[i] = i;}
\DoxyCodeLine{43     \}}
\DoxyCodeLine{44   \});}
\DoxyCodeLine{45 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{46   std::iota(perm.begin(), perm.end(), 0);  \textcolor{comment}{// Parallelize Me!!}}
\DoxyCodeLine{47 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{48 }
\DoxyCodeLine{49   assert(perm.begin() != perm.end());}
\DoxyCodeLine{50 }
\DoxyCodeLine{51   std::sort(\textcolor{comment}{/*policy,*/} perm.begin(), perm.end(), [\&](\textcolor{keyword}{auto} a, \textcolor{keyword}{auto} b) \{ }
\DoxyCodeLine{52     assert(perm.size() == x.size());}
\DoxyCodeLine{53     assert(a < x.size());}
\DoxyCodeLine{54     assert(b < x.size());}
\DoxyCodeLine{55     return comp(x[a], x[b]); }
\DoxyCodeLine{56   \});}
\DoxyCodeLine{57 \}}
\DoxyCodeLine{58 }
\DoxyCodeLine{59 \textcolor{keyword}{template} <\textcolor{keyword}{typename} IntT = u\textcolor{keywordtype}{int}32\_t, \textcolor{keyword}{typename} Comparator, \textcolor{keyword}{typename} ThingToSort, \textcolor{keyword}{class} ExecutionPolicy = std::execution::parallel\_unsequenced\_policy>}
\DoxyCodeLine{60 \textcolor{keyword}{auto} proxysort(\textcolor{keyword}{const} ThingToSort\& x, Comparator comp = std::less<IntT>(), ExecutionPolicy policy = \{\}) \{}
\DoxyCodeLine{61   std::vector<IntT> perm(x.size());}
\DoxyCodeLine{62   proxysort(x, perm, comp, policy);}
\DoxyCodeLine{63   \textcolor{keywordflow}{return} perm;}
\DoxyCodeLine{64 \}}
\DoxyCodeLine{65 }
\DoxyCodeLine{66 \}    \textcolor{comment}{// namespace util}}
\DoxyCodeLine{67 \}    \textcolor{comment}{// namespace nw}}
\DoxyCodeLine{68 }
\DoxyCodeLine{69 \textcolor{preprocessor}{\#endif    }\textcolor{comment}{// NW\_UTIL\_PROXYSORT\_HPP}}

\end{DoxyCode}
