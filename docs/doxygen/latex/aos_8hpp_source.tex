\hypertarget{aos_8hpp_source}{}\doxysection{aos.\+hpp}
\label{aos_8hpp_source}\index{/Users/lums/NWmath/NWgr/include/nwgraph/containers/aos.hpp@{/Users/lums/NWmath/NWgr/include/nwgraph/containers/aos.hpp}}
\mbox{\hyperlink{aos_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// }}
\DoxyCodeLine{2 \textcolor{comment}{// This file is part of NW Graph (aka GraphPack) }}
\DoxyCodeLine{3 \textcolor{comment}{// (c) Pacific Northwest National Laboratory 2018-\/2021 }}
\DoxyCodeLine{4 \textcolor{comment}{// (c) University of Washington 2018-\/2021 }}
\DoxyCodeLine{5 \textcolor{comment}{// }}
\DoxyCodeLine{6 \textcolor{comment}{// Licensed under terms of include LICENSE file }}
\DoxyCodeLine{7 \textcolor{comment}{// }}
\DoxyCodeLine{8 \textcolor{comment}{// Authors: }}
\DoxyCodeLine{9 \textcolor{comment}{//     Andrew Lumsdaine }}
\DoxyCodeLine{10 \textcolor{comment}{//     Kevin Deweese    }}
\DoxyCodeLine{11 \textcolor{comment}{//}}
\DoxyCodeLine{12 }
\DoxyCodeLine{23 \textcolor{preprocessor}{\#ifndef NW\_GRAPH\_AOS\_HPP}}
\DoxyCodeLine{24 \textcolor{preprocessor}{\#define NW\_GRAPH\_AOS\_HPP}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include <execution>}}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include <algorithm>}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#include <cassert>}}
\DoxyCodeLine{30 }
\DoxyCodeLine{31 \textcolor{preprocessor}{\#include <fstream>}}
\DoxyCodeLine{32 \textcolor{preprocessor}{\#include <functional>}}
\DoxyCodeLine{33 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{34 \textcolor{preprocessor}{\#include <istream>}}
\DoxyCodeLine{35 \textcolor{preprocessor}{\#include <iterator>}}
\DoxyCodeLine{36 \textcolor{preprocessor}{\#include <ostream>}}
\DoxyCodeLine{37 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 \textcolor{preprocessor}{\#if defined(CL\_SYCL\_LANGUAGE\_VERSION)}}
\DoxyCodeLine{40 \textcolor{preprocessor}{\#include <dpstd/execution>}}
\DoxyCodeLine{41 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{42 \textcolor{preprocessor}{\#include <execution>}}
\DoxyCodeLine{43 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{44 }
\DoxyCodeLine{45 \textcolor{keyword}{namespace }nw \{}
\DoxyCodeLine{46 \textcolor{keyword}{namespace }graph \{}
\DoxyCodeLine{47 }
\DoxyCodeLine{48 \textcolor{comment}{// Bare bones array of structs (vector of tuples)}}
\DoxyCodeLine{49 \textcolor{keyword}{template} <\textcolor{keyword}{typename}... Attributes>}
\DoxyCodeLine{50 \textcolor{keyword}{class }\mbox{\hyperlink{classnw_1_1graph_1_1array__of__structs}{array\_of\_structs}} : \textcolor{keyword}{public} std::vector<std::tuple<Attributes...>> \{}
\DoxyCodeLine{51 }
\DoxyCodeLine{52 \textcolor{keyword}{public}:}
\DoxyCodeLine{53   \textcolor{keyword}{using} storage\_type = std::vector<std::tuple<Attributes...>>;}
\DoxyCodeLine{54   \textcolor{keyword}{using} base         = std::vector<std::tuple<Attributes...>>;}
\DoxyCodeLine{55   \textcolor{keyword}{using} reference    = \textcolor{keyword}{typename} std::iterator\_traits<typename storage\_type::iterator>::reference;}
\DoxyCodeLine{56 }
\DoxyCodeLine{57   \textcolor{comment}{//  storage\_type storage\_;}}
\DoxyCodeLine{58 }
\DoxyCodeLine{59 \textcolor{keyword}{public}:}
\DoxyCodeLine{60 \textcolor{preprocessor}{\#if 0}}
\DoxyCodeLine{61 }
\DoxyCodeLine{62   \textcolor{keywordtype}{void} clear() \{ storage\_.clear(); \}}
\DoxyCodeLine{63   \textcolor{keywordtype}{void} resize(\textcolor{keywordtype}{size\_t} n) \{ storage\_.resize(n); \}}
\DoxyCodeLine{64   \textcolor{keywordtype}{void} reserve(\textcolor{keywordtype}{size\_t} n) \{ storage\_.reserve(n); \}}
\DoxyCodeLine{65 }
\DoxyCodeLine{66   \textcolor{keyword}{auto} begin() \{ \textcolor{keywordflow}{return} storage\_.begin(); \}}
\DoxyCodeLine{67   \textcolor{keyword}{auto} end() \{ \textcolor{keywordflow}{return} storage\_.end(); \}}
\DoxyCodeLine{68 }
\DoxyCodeLine{69   \textcolor{keyword}{template} <\textcolor{keyword}{typename} It>}
\DoxyCodeLine{70   \textcolor{keywordtype}{void} erase(It b, It e) \{ storage\_.erase(b, e); \}}
\DoxyCodeLine{71   \textcolor{keywordtype}{size\_t} size()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} base::size(); \}}
\DoxyCodeLine{72 }
\DoxyCodeLine{73 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{74 }
\DoxyCodeLine{75   \textcolor{keywordtype}{void} push\_back(\textcolor{keyword}{const} std::tuple<Attributes...>\& attrs) \{ base::push\_back(attrs); \}}
\DoxyCodeLine{76   \textcolor{keywordtype}{void} push\_back(\textcolor{keyword}{const} std::tuple<Attributes\&...>\& attrs) \{ base::push\_back(attrs); \}}
\DoxyCodeLine{77   \textcolor{keywordtype}{void} push\_back(\textcolor{keyword}{const} Attributes\&... attrs) \{ base::push\_back(\{attrs...\}); \}}
\DoxyCodeLine{78 }
\DoxyCodeLine{79   \textcolor{keywordtype}{bool} operator==(\mbox{\hyperlink{classnw_1_1graph_1_1array__of__structs}{array\_of\_structs}}\& a) \{ \textcolor{keywordflow}{return} std::equal(std::execution::par, base::begin(), base::end(), a.begin()); \}}
\DoxyCodeLine{80   \textcolor{keywordtype}{bool} operator!=(\textcolor{keyword}{const} storage\_type\& a) \{ \textcolor{keywordflow}{return} !operator==(a); \}}
\DoxyCodeLine{81 }
\DoxyCodeLine{82   \textcolor{keyword}{template} <\textcolor{keywordtype}{size\_t}... Is>}
\DoxyCodeLine{83   \textcolor{keywordtype}{void} print\_helper(std::ostream\& output\_stream, std::tuple<Attributes...> attrs, std::index\_sequence<Is...>) \{}
\DoxyCodeLine{84     output\_stream << \textcolor{stringliteral}{"{}( "{}};}
\DoxyCodeLine{85     (..., (output\_stream << (0 == Is ? \textcolor{stringliteral}{"{}"{}} : \textcolor{stringliteral}{"{}, "{}}) << std::get<Is>(attrs)));}
\DoxyCodeLine{86     output\_stream << \textcolor{stringliteral}{"{} )"{}} << std::endl;}
\DoxyCodeLine{87   \}}
\DoxyCodeLine{88 }
\DoxyCodeLine{89   \textcolor{keywordtype}{void} stream(std::ostream\& output\_stream, \textcolor{keyword}{const} std::string\& msg = \textcolor{stringliteral}{"{}"{}}) \{}
\DoxyCodeLine{90     output\_stream << msg;}
\DoxyCodeLine{91     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\& element : *\textcolor{keyword}{this}) \{}
\DoxyCodeLine{92       print\_helper(output\_stream, element, std::make\_index\_sequence<\textcolor{keyword}{sizeof}...(Attributes)>());}
\DoxyCodeLine{93     \}}
\DoxyCodeLine{94   \}}
\DoxyCodeLine{95 }
\DoxyCodeLine{96   \textcolor{keywordtype}{void} stream(\textcolor{keyword}{const} std::string\& msg = \textcolor{stringliteral}{"{}"{}}) \{ stream(std::cout, msg); \}}
\DoxyCodeLine{97 }
\DoxyCodeLine{98   \textcolor{comment}{// size (number of elements)}}
\DoxyCodeLine{99   \textcolor{comment}{// sizeof data elements}}
\DoxyCodeLine{100   \textcolor{comment}{// data elements}}
\DoxyCodeLine{101 }
\DoxyCodeLine{102   \textcolor{keywordtype}{void} serialize(std::ostream\& outfile)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{103     \textcolor{keywordtype}{size\_t} st\_size = base::size();}
\DoxyCodeLine{104     \textcolor{keywordtype}{size\_t} el\_size = \textcolor{keyword}{sizeof}(\textcolor{keyword}{dynamic\_cast<}\textcolor{keyword}{const }base\&\textcolor{keyword}{>}(*this)[0]);}
\DoxyCodeLine{105 }
\DoxyCodeLine{106     outfile.write(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(\&st\_size), \textcolor{keyword}{sizeof}(size\_t));}
\DoxyCodeLine{107     outfile.write(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(\&el\_size), \textcolor{keyword}{sizeof}(size\_t));}
\DoxyCodeLine{108     outfile.write(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(base::data()), st\_size * el\_size);}
\DoxyCodeLine{109   \}}
\DoxyCodeLine{110 }
\DoxyCodeLine{111   \textcolor{keywordtype}{void} deserialize(std::istream\& infile) \{}
\DoxyCodeLine{112     \textcolor{keywordtype}{size\_t} st\_size = -\/1;}
\DoxyCodeLine{113     \textcolor{keywordtype}{size\_t} el\_size = -\/1;}
\DoxyCodeLine{114 }
\DoxyCodeLine{115     infile.read(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(\&st\_size), \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{size\_t}));}
\DoxyCodeLine{116     infile.read(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(\&el\_size), \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{size\_t}));}
\DoxyCodeLine{117     base::resize(st\_size);}
\DoxyCodeLine{118     infile.read(\textcolor{keyword}{reinterpret\_cast<}\textcolor{keywordtype}{char}*\textcolor{keyword}{>}(base::data()), st\_size * el\_size);}
\DoxyCodeLine{119   \}}
\DoxyCodeLine{120 \};}
\DoxyCodeLine{121 \}    \textcolor{comment}{// namespace graph}}
\DoxyCodeLine{122 \}    \textcolor{comment}{// namespace nw}}
\DoxyCodeLine{123 \textcolor{preprocessor}{\#endif    }\textcolor{comment}{// NW\_GRAPH\_AOS\_HPP}}

\end{DoxyCode}
