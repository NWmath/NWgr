\hypertarget{dag__range_8hpp_source}{}\doxysection{dag\+\_\+range.\+hpp}
\label{dag__range_8hpp_source}\index{/Users/lums/NWmath/NWgr/include/nwgraph/adaptors/dag\_range.hpp@{/Users/lums/NWmath/NWgr/include/nwgraph/adaptors/dag\_range.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// }}
\DoxyCodeLine{2 \textcolor{comment}{// This file is part of NW Graph (aka GraphPack) }}
\DoxyCodeLine{3 \textcolor{comment}{// (c) Pacific Northwest National Laboratory 2018-\/2021 }}
\DoxyCodeLine{4 \textcolor{comment}{// (c) University of Washington 2018-\/2021 }}
\DoxyCodeLine{5 \textcolor{comment}{// }}
\DoxyCodeLine{6 \textcolor{comment}{// Licensed under terms of include LICENSE file }}
\DoxyCodeLine{7 \textcolor{comment}{// }}
\DoxyCodeLine{8 \textcolor{comment}{// Authors: }}
\DoxyCodeLine{9 \textcolor{comment}{//     Andrew Lumsdaine }}
\DoxyCodeLine{10 \textcolor{comment}{//     Kevin Deweese    }}
\DoxyCodeLine{11 \textcolor{comment}{//}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#ifndef NW\_GRAPH\_DAG\_RANGE\_HPP}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#define NW\_GRAPH\_DAG\_RANGE\_HPP}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include <queue>}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include "{}nwgraph/graph\_traits.hpp"{}}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{keyword}{namespace }nw \{}
\DoxyCodeLine{22 \textcolor{keyword}{namespace }graph \{}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{keyword}{enum} ready\_to\_process \{ yes, no \};}
\DoxyCodeLine{25 }
\DoxyCodeLine{26 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Graph, \textcolor{keyword}{typename} Queue = std::queue<vertex\_\textcolor{keywordtype}{id}\_t<Graph>>>}
\DoxyCodeLine{27 \textcolor{keyword}{class }\mbox{\hyperlink{classnw_1_1graph_1_1dag__range}{dag\_range}} \{}
\DoxyCodeLine{28 }
\DoxyCodeLine{29 \textcolor{keyword}{public}:}
\DoxyCodeLine{30   \textcolor{keyword}{using} vertex\_id\_type = vertex\_id\_t<Graph>;}
\DoxyCodeLine{31 }
\DoxyCodeLine{32   \textcolor{keyword}{typedef} std::vector<std::vector<size\_t>> VOV;}
\DoxyCodeLine{33 }
\DoxyCodeLine{34   \mbox{\hyperlink{classnw_1_1graph_1_1dag__range}{dag\_range}}(Graph\& graph, VOV pred\_list, VOV successor\_list)}
\DoxyCodeLine{35       : the\_graph\_(graph), \_predecessor\_list(pred\_list), \_successor\_list(successor\_list) \{}
\DoxyCodeLine{36     \textcolor{comment}{/*Set all pred done counter to zero*/}}
\DoxyCodeLine{37     \_pred\_done\_counter.resize(the\_graph\_.size(), 0);}
\DoxyCodeLine{38     \textcolor{comment}{/*Insert all the roots in the queue*/}}
\DoxyCodeLine{39     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < the\_graph\_.size(); i++) \{}
\DoxyCodeLine{40       \textcolor{keywordflow}{if} (pred\_list[i].size() == 0) \{}
\DoxyCodeLine{41         Q\_.push(i);}
\DoxyCodeLine{42       \}}
\DoxyCodeLine{43     \}}
\DoxyCodeLine{44   \}}
\DoxyCodeLine{45   \mbox{\hyperlink{classnw_1_1graph_1_1dag__range}{dag\_range}}(\textcolor{keyword}{const} \mbox{\hyperlink{classnw_1_1graph_1_1dag__range}{dag\_range}}\&)  = \textcolor{keyword}{delete};}
\DoxyCodeLine{46   \mbox{\hyperlink{classnw_1_1graph_1_1dag__range}{dag\_range}}(\textcolor{keyword}{const} \mbox{\hyperlink{classnw_1_1graph_1_1dag__range}{dag\_range}}\&\&) = \textcolor{keyword}{delete};}
\DoxyCodeLine{47 }
\DoxyCodeLine{48   \textcolor{keywordtype}{bool} empty() \{ \textcolor{keywordflow}{return} Q\_.empty(); \}}
\DoxyCodeLine{49 }
\DoxyCodeLine{50   \textcolor{keyword}{class }\mbox{\hyperlink{classnw_1_1graph_1_1dag__range_1_1dag__range__iterator}{dag\_range\_iterator}} \{}
\DoxyCodeLine{51   \textcolor{keyword}{private}:}
\DoxyCodeLine{52     \mbox{\hyperlink{classnw_1_1graph_1_1dag__range}{dag\_range<Graph, Queue>}}\&      the\_range\_;}
\DoxyCodeLine{53     vertex\_id\_type                v\_;}
\DoxyCodeLine{54     std::vector<size\_t>::iterator successor\_iterator;}
\DoxyCodeLine{55 }
\DoxyCodeLine{56   \textcolor{keyword}{public}:}
\DoxyCodeLine{57     \mbox{\hyperlink{classnw_1_1graph_1_1dag__range_1_1dag__range__iterator}{dag\_range\_iterator}}(\mbox{\hyperlink{classnw_1_1graph_1_1dag__range}{dag\_range<Graph>}}\& range)}
\DoxyCodeLine{58         : the\_range\_(range), v\_(the\_range\_.Q\_.front()), successor\_iterator(the\_range\_.\_successor\_list[v\_].begin()) \{}
\DoxyCodeLine{59       advance\_next();}
\DoxyCodeLine{60     \}}
\DoxyCodeLine{61 }
\DoxyCodeLine{62     \textcolor{keywordtype}{void} advance\_next() \{}
\DoxyCodeLine{63       \textcolor{keyword}{auto}\& Q = the\_range\_.Q\_;}
\DoxyCodeLine{64       \textcolor{comment}{/*Check whether we have processed all the successors of the current vertex*/}}
\DoxyCodeLine{65       \textcolor{keywordflow}{if} (successor\_iterator == the\_range\_.\_successor\_list[v\_].end()) \{}
\DoxyCodeLine{66         Q.pop(); \textcolor{comment}{/*remove current vertex*/}}
\DoxyCodeLine{67         \textcolor{keywordflow}{while} (!Q.empty()) \{}
\DoxyCodeLine{68           v\_ = Q.front(); \textcolor{comment}{/*If not empty, get the next vertex*/}}
\DoxyCodeLine{69           \textcolor{comment}{/*If no successor, continue for the next*/}}
\DoxyCodeLine{70           \textcolor{keywordflow}{if} (the\_range\_.\_successor\_list[v\_].size() == 0) \{}
\DoxyCodeLine{71             Q.pop();}
\DoxyCodeLine{72             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{73           \}}
\DoxyCodeLine{74           \textcolor{comment}{/*We have to make sure that the last vertex in the queue*/}}
\DoxyCodeLine{75           \textcolor{keywordflow}{if} (the\_range\_.\_successor\_list[v\_].size() > 0) \{}
\DoxyCodeLine{76             \textcolor{comment}{/*Reset the iterator for the successor list*/}}
\DoxyCodeLine{77             successor\_iterator = the\_range\_.\_successor\_list[v\_].begin();}
\DoxyCodeLine{78             \textcolor{keywordflow}{break};}
\DoxyCodeLine{79           \}}
\DoxyCodeLine{80         \}}
\DoxyCodeLine{81       \}}
\DoxyCodeLine{82       \textcolor{keywordflow}{if} (the\_range\_.\_successor\_list[v\_].size() > 0) \{}
\DoxyCodeLine{83         the\_range\_.\_ready\_to\_process = no;}
\DoxyCodeLine{84         the\_range\_.\_pred\_done\_counter[*successor\_iterator] += 1;}
\DoxyCodeLine{85         \textcolor{keywordflow}{if} (the\_range\_.\_pred\_done\_counter[*successor\_iterator] == the\_range\_.\_predecessor\_list[*successor\_iterator].size()) \{}
\DoxyCodeLine{86           the\_range\_.\_ready\_to\_process = yes;}
\DoxyCodeLine{87           Q.push(*successor\_iterator);}
\DoxyCodeLine{88         \}}
\DoxyCodeLine{89       \}}
\DoxyCodeLine{90     \}}
\DoxyCodeLine{91 }
\DoxyCodeLine{92     \mbox{\hyperlink{classnw_1_1graph_1_1dag__range_1_1dag__range__iterator}{dag\_range\_iterator}}\& operator++() \{}
\DoxyCodeLine{93       successor\_iterator++;}
\DoxyCodeLine{94       advance\_next();}
\DoxyCodeLine{95       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};}
\DoxyCodeLine{96     \}}
\DoxyCodeLine{97 }
\DoxyCodeLine{98     \textcolor{keyword}{auto} operator*() \{}
\DoxyCodeLine{99       \textcolor{keywordflow}{return} std::tuple<vertex\_id\_type, vertex\_id\_type, ready\_to\_process>(v\_, *successor\_iterator, the\_range\_.\_ready\_to\_process);}
\DoxyCodeLine{100     \}}
\DoxyCodeLine{101     \textcolor{keyword}{class }\mbox{\hyperlink{classnw_1_1graph_1_1dag__range_1_1dag__range__iterator_1_1end__sentinel__type}{end\_sentinel\_type}} \{}
\DoxyCodeLine{102     \textcolor{keyword}{public}:}
\DoxyCodeLine{103       \mbox{\hyperlink{classnw_1_1graph_1_1dag__range_1_1dag__range__iterator_1_1end__sentinel__type}{end\_sentinel\_type}}() \{\}}
\DoxyCodeLine{104     \};}
\DoxyCodeLine{105     \textcolor{keyword}{auto} operator==(\textcolor{keyword}{const} \mbox{\hyperlink{classnw_1_1graph_1_1dag__range_1_1dag__range__iterator_1_1end__sentinel__type}{end\_sentinel\_type}}\&)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} the\_range\_.empty(); \}}
\DoxyCodeLine{106     \textcolor{keywordtype}{bool} operator!=(\textcolor{keyword}{const} end\_sentinel\_type\&)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} !the\_range\_.empty(); \}}
\DoxyCodeLine{107   \};}
\DoxyCodeLine{108   \textcolor{keyword}{auto} begin() \{ \textcolor{keywordflow}{return} dag\_range\_iterator(*\textcolor{keyword}{this}); \}}
\DoxyCodeLine{109   \textcolor{keyword}{auto} end() \{ \textcolor{keywordflow}{return} \textcolor{keyword}{typename} dag\_range\_iterator::end\_sentinel\_type(); \}}
\DoxyCodeLine{110 }
\DoxyCodeLine{111 \textcolor{keyword}{private}:}
\DoxyCodeLine{112   Graph\&                the\_graph\_;}
\DoxyCodeLine{113   Queue                 Q\_;}
\DoxyCodeLine{114   VOV                   \_predecessor\_list;}
\DoxyCodeLine{115   VOV                   \_successor\_list;}
\DoxyCodeLine{116   std::vector<uint64\_t> \_pred\_done\_counter;}
\DoxyCodeLine{117   ready\_to\_process      \_ready\_to\_process;}
\DoxyCodeLine{118 \};}
\DoxyCodeLine{119 }
\DoxyCodeLine{120 \}    \textcolor{comment}{// namespace graph}}
\DoxyCodeLine{121 \}    \textcolor{comment}{// namespace nw}}
\DoxyCodeLine{122 }
\DoxyCodeLine{123 \textcolor{preprocessor}{\#endif    }\textcolor{comment}{// NW\_GRAPH\_DAG\_RANGE\_HPP}}

\end{DoxyCode}
