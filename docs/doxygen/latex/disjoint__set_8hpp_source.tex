\hypertarget{disjoint__set_8hpp_source}{}\doxysection{disjoint\+\_\+set.\+hpp}
\label{disjoint__set_8hpp_source}\index{/Users/lums/NWmath/NWgr/include/nwgraph/util/disjoint\_set.hpp@{/Users/lums/NWmath/NWgr/include/nwgraph/util/disjoint\_set.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// }}
\DoxyCodeLine{2 \textcolor{comment}{// This file is part of NW Graph (aka GraphPack) }}
\DoxyCodeLine{3 \textcolor{comment}{// (c) Pacific Northwest National Laboratory 2018-\/2021 }}
\DoxyCodeLine{4 \textcolor{comment}{// (c) University of Washington 2018-\/2021 }}
\DoxyCodeLine{5 \textcolor{comment}{// }}
\DoxyCodeLine{6 \textcolor{comment}{// Licensed under terms of include LICENSE file }}
\DoxyCodeLine{7 \textcolor{comment}{// }}
\DoxyCodeLine{8 \textcolor{comment}{// Authors: }}
\DoxyCodeLine{9 \textcolor{comment}{//     Andrew Lumsdaine }}
\DoxyCodeLine{10 \textcolor{comment}{//     Kevin Deweese    }}
\DoxyCodeLine{11 \textcolor{comment}{//}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#ifndef NW\_GRAPH\_DISJOINT\_SET\_HPP}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#define NW\_GRAPH\_DISJOINT\_SET\_HPP}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include <cassert>}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <map>}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include <set>}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include <stack>}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <string.h>}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 \textcolor{preprocessor}{\#if defined(CL\_SYCL\_LANGUAGE\_VERSION)}}
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <dpstd/execution>}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include <execution>}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{29 }
\DoxyCodeLine{30 \textcolor{preprocessor}{\#include "{}nwgraph/util/defaults.hpp"{}}}
\DoxyCodeLine{31 }
\DoxyCodeLine{32 \textcolor{keyword}{namespace }nw \{}
\DoxyCodeLine{33 \textcolor{keyword}{namespace }graph \{}
\DoxyCodeLine{34 }
\DoxyCodeLine{35 \textcolor{keyword}{using} vertex\_id\_type = default\_vertex\_id\_type;}
\DoxyCodeLine{36 }
\DoxyCodeLine{37 vertex\_id\_type disjoint\_find(std::vector<std::pair<vertex\_id\_type, size\_t>>\& subsets, vertex\_id\_type vtx) \{}
\DoxyCodeLine{38   vertex\_id\_type parent = subsets[vtx].first;}
\DoxyCodeLine{39   \textcolor{keywordflow}{while} (parent != subsets[parent].first) \{}
\DoxyCodeLine{40     parent = subsets[parent].first;}
\DoxyCodeLine{41   \}}
\DoxyCodeLine{42   \textcolor{keywordflow}{while} (vtx != parent) \{}
\DoxyCodeLine{43     vtx                = subsets[vtx].first;}
\DoxyCodeLine{44     subsets[vtx].first = parent;}
\DoxyCodeLine{45   \}}
\DoxyCodeLine{46 }
\DoxyCodeLine{47   \textcolor{keywordflow}{return} parent;}
\DoxyCodeLine{48 \}}
\DoxyCodeLine{49 }
\DoxyCodeLine{50 \textcolor{keywordtype}{void} disjoint\_union(std::vector<std::pair<vertex\_id\_type, size\_t>>\& subsets, vertex\_id\_type u, vertex\_id\_type v) \{}
\DoxyCodeLine{51   vertex\_id\_type u\_root = disjoint\_find(subsets, u);}
\DoxyCodeLine{52   vertex\_id\_type v\_root = disjoint\_find(subsets, v);}
\DoxyCodeLine{53 }
\DoxyCodeLine{54   \textcolor{keywordflow}{if} (subsets[u\_root].second < subsets[v\_root].second)}
\DoxyCodeLine{55     subsets[u\_root].first = v\_root;}
\DoxyCodeLine{56 }
\DoxyCodeLine{57   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (subsets[u\_root].second > subsets[v\_root].second)}
\DoxyCodeLine{58     subsets[v\_root].first = u\_root;}
\DoxyCodeLine{59 }
\DoxyCodeLine{60   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{61     subsets[v\_root].first = u\_root;}
\DoxyCodeLine{62     subsets[u\_root].second++;}
\DoxyCodeLine{63   \}}
\DoxyCodeLine{64 \}}
\DoxyCodeLine{65 }
\DoxyCodeLine{66 \textcolor{keywordtype}{bool} disjoint\_union\_find(std::vector<std::pair<vertex\_id\_type, size\_t>>\& subsets, vertex\_id\_type u, vertex\_id\_type v) \{}
\DoxyCodeLine{67   vertex\_id\_type u\_root = disjoint\_find(subsets, u);}
\DoxyCodeLine{68   vertex\_id\_type v\_root = disjoint\_find(subsets, v);}
\DoxyCodeLine{69 }
\DoxyCodeLine{70   \textcolor{keywordflow}{if} (u\_root != v\_root) \{}
\DoxyCodeLine{71 }
\DoxyCodeLine{72     \textcolor{keywordflow}{if} (subsets[u\_root].second < subsets[v\_root].second)}
\DoxyCodeLine{73       subsets[u\_root].first = v\_root;}
\DoxyCodeLine{74 }
\DoxyCodeLine{75     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (subsets[u\_root].second > subsets[v\_root].second)}
\DoxyCodeLine{76       subsets[v\_root].first = u\_root;}
\DoxyCodeLine{77 }
\DoxyCodeLine{78     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{79       subsets[v\_root].first = u\_root;}
\DoxyCodeLine{80       subsets[u\_root].second++;}
\DoxyCodeLine{81     \}}
\DoxyCodeLine{82 }
\DoxyCodeLine{83     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{84   \}}
\DoxyCodeLine{85 }
\DoxyCodeLine{86   \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{87 \}}
\DoxyCodeLine{88 }
\DoxyCodeLine{89 \textcolor{comment}{/*}}
\DoxyCodeLine{90 \textcolor{comment}{ * UnionFind data structure for disjoint sets (i.e., sets that donâ€™t overlap).}}
\DoxyCodeLine{91 \textcolor{comment}{ * Implemenation is based Union-\/Find data structure.}}
\DoxyCodeLine{92 \textcolor{comment}{ * Implemented union-\/by-\/size and union-\/by height.}}
\DoxyCodeLine{93 \textcolor{comment}{ * Implemented both simple find and path compression find.}}
\DoxyCodeLine{94 \textcolor{comment}{ * Union-\/by-\/height or Union-\/by-\/size with simple find has a}}
\DoxyCodeLine{95 \textcolor{comment}{ * worse case runtime O(mlogn) for m operations.}}
\DoxyCodeLine{96 \textcolor{comment}{ * Union-\/by-\/height or Union-\/by-\/size with path compression find}}
\DoxyCodeLine{97 \textcolor{comment}{ * has a worse case runtime O(mlog*n) for m operations.}}
\DoxyCodeLine{98 \textcolor{comment}{ */}}
\DoxyCodeLine{99 \textcolor{keyword}{template} <\textcolor{keyword}{class} T>}
\DoxyCodeLine{100 \textcolor{keyword}{class }\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set}{disjoint\_set}} \{}
\DoxyCodeLine{101 \textcolor{keyword}{public}:}
\DoxyCodeLine{102   \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set}{disjoint\_set}}() : \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a003da270e650bfb2b0d83fbb6daca749}{nsets\_}}(0), \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}(0), sets\_(\textcolor{keyword}{nullptr}) \{}
\DoxyCodeLine{103     \textcolor{keywordflow}{if} (std::is\_unsigned<T>::value) \{}
\DoxyCodeLine{104       std::cerr << \textcolor{stringliteral}{"{}only support signed number"{}} << std::endl;}
\DoxyCodeLine{105       exit(EXIT\_FAILURE);}
\DoxyCodeLine{106     \}}
\DoxyCodeLine{107   \}}
\DoxyCodeLine{113   \textcolor{keyword}{explicit} \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a96520a36845f3275b33c8595c0a41217}{disjoint\_set}}(T max\_element) : \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a003da270e650bfb2b0d83fbb6daca749}{nsets\_}}(max\_element), \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}(max\_element) \{}
\DoxyCodeLine{114     \textcolor{keywordflow}{if} (std::is\_unsigned<T>::value) \{}
\DoxyCodeLine{115       std::cerr << \textcolor{stringliteral}{"{}only support signed number"{}} << std::endl;}
\DoxyCodeLine{116       exit(EXIT\_FAILURE);}
\DoxyCodeLine{117     \}}
\DoxyCodeLine{118     this-\/>sets\_ = \textcolor{keyword}{new} T[max\_element];}
\DoxyCodeLine{119     memset(this-\/>sets\_, -\/1, \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}} * \textcolor{keyword}{sizeof}(T));}
\DoxyCodeLine{120   \}}
\DoxyCodeLine{125   \textcolor{keyword}{explicit} \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_aa372a0e70dd53e70d65fcbb3eec41280}{disjoint\_set}}(\textcolor{keyword}{const} \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set}{disjoint\_set<T>}}\& other) : \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a003da270e650bfb2b0d83fbb6daca749}{nsets\_}}(other.\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a003da270e650bfb2b0d83fbb6daca749}{nsets\_}}), \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}(other.\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}) \{}
\DoxyCodeLine{126     \textcolor{keywordflow}{if} (std::is\_unsigned<T>::value) \{}
\DoxyCodeLine{127       std::cerr << \textcolor{stringliteral}{"{}only support signed number"{}} << std::endl;}
\DoxyCodeLine{128       exit(EXIT\_FAILURE);}
\DoxyCodeLine{129     \}}
\DoxyCodeLine{130     \textcolor{keyword}{delete}[] this-\/>sets\_;}
\DoxyCodeLine{131     this-\/>sets\_ = \textcolor{keyword}{new} T[other.\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}];}
\DoxyCodeLine{132     memcpy(this-\/>sets\_, other.sets\_, \textcolor{keyword}{sizeof}(T) * other.\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}});}
\DoxyCodeLine{133   \}}
\DoxyCodeLine{134 }
\DoxyCodeLine{135   \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set}{\string~disjoint\_set}}() \{ \textcolor{keyword}{delete}[] this-\/>sets\_; \}}
\DoxyCodeLine{136 }
\DoxyCodeLine{141   \textcolor{keywordtype}{void} \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_ae3e5eca8e06b9a836bb2fdfd437ec354}{reset}}() \{ memset(this-\/>sets\_, -\/1, \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}} * \textcolor{keyword}{sizeof}(T)); \}}
\DoxyCodeLine{146   \textcolor{keywordtype}{void} \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_aacbbd3ec3ebdb22e65316493675cbe4e}{reset}}(\textcolor{keyword}{const} T index) \{}
\DoxyCodeLine{147     \textcolor{comment}{//element must be between 0 to size()}}
\DoxyCodeLine{148     \textcolor{keywordflow}{if} (index > this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}} || index < 0) \{}
\DoxyCodeLine{149       \textcolor{keywordflow}{throw} std::range\_error(std::to\_string(index) + \textcolor{stringliteral}{"{}is out of range\(\backslash\)n"{}});}
\DoxyCodeLine{150     \}}
\DoxyCodeLine{151     this-\/>sets\_[index] = index;}
\DoxyCodeLine{152   \}}
\DoxyCodeLine{156   \textcolor{keyword}{template} <\textcolor{keyword}{class} ExecutionPolicy = std::execution::parallel\_unsequenced\_policy>}
\DoxyCodeLine{157   \textcolor{keywordtype}{void} \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a4bb47c8fa742b5fd82567ff18d40bb17}{allToSingletons}}(ExecutionPolicy\&\& policy = \{\}) \{}
\DoxyCodeLine{158     \textcolor{keywordtype}{size\_t} i = 0;}
\DoxyCodeLine{159     std::for\_each(policy, this-\/>sets\_, this-\/>sets\_ + this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}, [\&i, \textcolor{keyword}{this}]() \{}
\DoxyCodeLine{160       this-\/>sets[i] = i;}
\DoxyCodeLine{161       ++i;}
\DoxyCodeLine{162     \});}
\DoxyCodeLine{163   \}}
\DoxyCodeLine{164   \textcolor{keyword}{template} <\textcolor{keyword}{typename} L>}
\DoxyCodeLine{165   \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a4bb47c8fa742b5fd82567ff18d40bb17}{allToSingletons}}(L* arr, \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} size) \{}
\DoxyCodeLine{166     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < size; ++i)}
\DoxyCodeLine{167       arr[i] = i;}
\DoxyCodeLine{168   \}}
\DoxyCodeLine{169   \textcolor{keyword}{template} <\textcolor{keyword}{typename} L>}
\DoxyCodeLine{170   \textcolor{keyword}{static} \textcolor{keywordtype}{void} \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a4bb47c8fa742b5fd82567ff18d40bb17}{allToSingletons}}(std::vector<L>\& arr, \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} size) \{}
\DoxyCodeLine{171     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < size; ++i)}
\DoxyCodeLine{172       arr[i] = i;}
\DoxyCodeLine{173   \}}
\DoxyCodeLine{179   \textcolor{keyword}{virtual} T \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a3b80f8dd1e1cd5e8c4830a5eca4c5b1d}{find\_with\_pathcompression}}(T index) \{}
\DoxyCodeLine{180     \textcolor{comment}{//element must be between 0 to size()}}
\DoxyCodeLine{181     \textcolor{keywordflow}{if} (index > this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}} || index < 0) \{}
\DoxyCodeLine{182       \textcolor{keywordflow}{throw} std::range\_error(std::to\_string(index) + \textcolor{stringliteral}{"{}is out of range\(\backslash\)n"{}});}
\DoxyCodeLine{183     \}}
\DoxyCodeLine{184     \textcolor{comment}{//negative means index is a root}}
\DoxyCodeLine{185     \textcolor{keywordflow}{if} (0 > this-\/>sets\_[index]) \{}
\DoxyCodeLine{186       \textcolor{keywordflow}{return} index;}
\DoxyCodeLine{187     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{188       \textcolor{comment}{//positive means index is not a root.}}
\DoxyCodeLine{189       \textcolor{comment}{// recursion and path compression}}
\DoxyCodeLine{190       \textcolor{comment}{//return this-\/>sets\_[u] = find\_with\_pathcompression(this-\/>sets\_[u]);}}
\DoxyCodeLine{191 }
\DoxyCodeLine{192       \textcolor{comment}{//non-\/recurisve find with path compression}}
\DoxyCodeLine{193       std::stack<T> s;}
\DoxyCodeLine{194       \textcolor{comment}{//we iterate through the sets\_[index] until a negative is found}}
\DoxyCodeLine{195       \textcolor{comment}{//a negative means index is a root.}}
\DoxyCodeLine{196       \textcolor{keywordflow}{while} (0 <= this-\/>sets\_[index]) \{}
\DoxyCodeLine{197         s.push(index);}
\DoxyCodeLine{198         index = this-\/>sets\_[index];}
\DoxyCodeLine{199       \}}
\DoxyCodeLine{200       \textcolor{comment}{//Path compression: assign all the accessed sets\_[index] to root}}
\DoxyCodeLine{201       \textcolor{keywordflow}{while} (!s.empty()) \{}
\DoxyCodeLine{202         this-\/>sets\_[s.top()] = index;}
\DoxyCodeLine{203         s.pop();}
\DoxyCodeLine{204       \}}
\DoxyCodeLine{205       \textcolor{keywordflow}{return} index;}
\DoxyCodeLine{206     \}}
\DoxyCodeLine{207   \}}
\DoxyCodeLine{208   \textcolor{keyword}{static} T \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a3b80f8dd1e1cd5e8c4830a5eca4c5b1d}{find\_with\_pathcompression}}(\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set}{disjoint\_set<T>}}\& s, T index) \{ \textcolor{keywordflow}{return} s.\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a3b80f8dd1e1cd5e8c4830a5eca4c5b1d}{find\_with\_pathcompression}}(index); \}}
\DoxyCodeLine{214   \textcolor{keyword}{virtual} T \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_af306ad0e3e6f9a7508d44fe13c55e3a5}{find}}(T index)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{215     \textcolor{comment}{//element must be between 0 to size()}}
\DoxyCodeLine{216     \textcolor{keywordflow}{if} (index > this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}} || index < 0) \{}
\DoxyCodeLine{217       \textcolor{keywordflow}{throw} std::range\_error(std::to\_string(index) + \textcolor{stringliteral}{"{}is out of range\(\backslash\)n"{}});}
\DoxyCodeLine{218     \}}
\DoxyCodeLine{219     \textcolor{comment}{//recursion and simple find}}
\DoxyCodeLine{220     \textcolor{comment}{//return find(this-\/>sets\_[u]);}}
\DoxyCodeLine{221 }
\DoxyCodeLine{222     \textcolor{comment}{//non-\/recursive simple find}}
\DoxyCodeLine{223     \textcolor{comment}{//negative means root}}
\DoxyCodeLine{224     \textcolor{keyword}{volatile} T t = 0;}
\DoxyCodeLine{225     \textcolor{keywordflow}{while} (0 <= this-\/>sets\_[t]) \{}
\DoxyCodeLine{226       \textcolor{comment}{//if (t > this-\/>maxid\_ || t < 0) \{}}
\DoxyCodeLine{227       t = this-\/>sets\_[t];}
\DoxyCodeLine{228     \}}
\DoxyCodeLine{229     \textcolor{keywordflow}{return} t;}
\DoxyCodeLine{230   \}}
\DoxyCodeLine{237   \textcolor{keyword}{static} T \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_aaf75c7579562ea1f881bbf318c5dc0a6}{find}}(\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set}{disjoint\_set<T>}}\& s, T index) \{ \textcolor{keywordflow}{return} s.\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_af306ad0e3e6f9a7508d44fe13c55e3a5}{find}}(index); \}}
\DoxyCodeLine{243   \textcolor{keyword}{virtual} T \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_aca15e8e1dc1ed118fd97941471d2c3b3}{directFind}}(\textcolor{keyword}{const} T index)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{244     \textcolor{comment}{//element must be between 0 to maxid\_}}
\DoxyCodeLine{245     \textcolor{comment}{//element must be between 0 to size()}}
\DoxyCodeLine{246     \textcolor{keywordflow}{if} (index > this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}} || index < 0) \{}
\DoxyCodeLine{247       \textcolor{keywordflow}{throw} std::range\_error(std::to\_string(index) + \textcolor{stringliteral}{"{}is out of range\(\backslash\)n"{}});}
\DoxyCodeLine{248     \}}
\DoxyCodeLine{249 }
\DoxyCodeLine{250     \textcolor{keywordflow}{return} this-\/>sets\_[index];}
\DoxyCodeLine{251   \}}
\DoxyCodeLine{252 }
\DoxyCodeLine{258   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a3486799caa0880665810fed4d12cec36}{join}}(T \textcolor{keyword}{const}\& u, T \textcolor{keyword}{const}\& v) \{}
\DoxyCodeLine{259     \textcolor{keywordflow}{if} (u == v) \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{260     T rootu = \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_af306ad0e3e6f9a7508d44fe13c55e3a5}{find}}(u);}
\DoxyCodeLine{261     T rootv = \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_af306ad0e3e6f9a7508d44fe13c55e3a5}{find}}(v);}
\DoxyCodeLine{262     \textcolor{keywordflow}{if} (rootu != rootv) \{}
\DoxyCodeLine{263       \textcolor{comment}{//if u and v are not in the same set}}
\DoxyCodeLine{264       \textcolor{keywordflow}{if} (-\/1 > this-\/>sets\_[rootv]) \{}
\DoxyCodeLine{265         \textcolor{comment}{//if v is not a singleton set, it belongs to setOf(rootv)}}
\DoxyCodeLine{266         \textcolor{keywordflow}{if} (v != rootv) \{}
\DoxyCodeLine{267           \textcolor{comment}{//if v leaves setRootV to setRootU}}
\DoxyCodeLine{268           \textcolor{comment}{//decrement the size of setOf(rootv)}}
\DoxyCodeLine{269           ++this-\/>sets\_[rootv];}
\DoxyCodeLine{270           \textcolor{comment}{//increment the size of setOf(rootu)}}
\DoxyCodeLine{271           -\/-\/this-\/>sets\_[rootu];}
\DoxyCodeLine{272           \textcolor{comment}{//change the root of v to root of u}}
\DoxyCodeLine{273           this-\/>sets\_[v] = rootu;}
\DoxyCodeLine{274         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{275           \textcolor{comment}{//if v is a root, it will join all its set to setOf(rootU)}}
\DoxyCodeLine{276           \textcolor{comment}{//combine the size of setOf(rootu) and setOf(rootv)}}
\DoxyCodeLine{277           this-\/>sets\_[rootu] += this-\/>sets\_[rootv];}
\DoxyCodeLine{278           \textcolor{comment}{//change the the root of v to root of u}}
\DoxyCodeLine{279           this-\/>sets\_[v] = rootu;}
\DoxyCodeLine{280         \}}
\DoxyCodeLine{281       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{282         \textcolor{comment}{// v is a singleton set, we just change its membership}}
\DoxyCodeLine{283         \textcolor{comment}{//change the the root of v to root of u}}
\DoxyCodeLine{284         this-\/>sets\_[v] = rootu;}
\DoxyCodeLine{285         \textcolor{comment}{//increment the size of setOf(rootu)}}
\DoxyCodeLine{286         -\/-\/this-\/>sets\_[rootu];}
\DoxyCodeLine{287         \textcolor{comment}{//the size of all the set decrement 1}}
\DoxyCodeLine{288         -\/-\/this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a003da270e650bfb2b0d83fbb6daca749}{nsets\_}};}
\DoxyCodeLine{289       \}}
\DoxyCodeLine{290       \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{291     \}}
\DoxyCodeLine{292     \textcolor{comment}{//if u v have the same root}}
\DoxyCodeLine{293     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{294   \}}
\DoxyCodeLine{300   \textcolor{keyword}{virtual} \textcolor{keywordtype}{bool} \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a927fa97e6125d0c6682b41537db34a13}{directJoin}}(T \textcolor{keyword}{const}\& u, T \textcolor{keyword}{const}\& v) \{}
\DoxyCodeLine{301     \textcolor{comment}{//element must be between 0 to size()}}
\DoxyCodeLine{302     \textcolor{keywordflow}{if} (v > this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}} || v < 0) \{}
\DoxyCodeLine{303       \textcolor{keywordflow}{throw} std::range\_error(std::to\_string(v) + \textcolor{stringliteral}{"{}is out of range\(\backslash\)n"{}});}
\DoxyCodeLine{304     \}}
\DoxyCodeLine{305     this-\/>sets\_[v] = u;}
\DoxyCodeLine{306     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{307   \}}
\DoxyCodeLine{320   \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a8e918d130954f8430b42fd7e40815986}{unionBySize}}(T \textcolor{keyword}{const}\& u, T \textcolor{keyword}{const}\& v) \{}
\DoxyCodeLine{321     T rootu = \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_af306ad0e3e6f9a7508d44fe13c55e3a5}{find}}(u);}
\DoxyCodeLine{322     T rootv = \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_af306ad0e3e6f9a7508d44fe13c55e3a5}{find}}(v);}
\DoxyCodeLine{323     \textcolor{keywordflow}{if} (rootu != rootv) \{}
\DoxyCodeLine{324       \textcolor{comment}{//if u, v does not belong to the same set}}
\DoxyCodeLine{325       \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_af49a079a84612551ce66479721902042}{combineBySize}}(rootu, rootv);}
\DoxyCodeLine{326       -\/-\/this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a003da270e650bfb2b0d83fbb6daca749}{nsets\_}};}
\DoxyCodeLine{327     \}}
\DoxyCodeLine{328   \}}
\DoxyCodeLine{329   \textcolor{keyword}{static} \textcolor{keywordtype}{void}  \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a8e918d130954f8430b42fd7e40815986}{unionBySize}}(\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set}{disjoint\_set<T>}}\& s, T \textcolor{keyword}{const}\& u, T \textcolor{keyword}{const}\& v) \{ s.\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a8e918d130954f8430b42fd7e40815986}{unionBySize}}(u, v); \}}
\DoxyCodeLine{330   \textcolor{keyword}{virtual} \textcolor{keywordtype}{void} unionByHeight(T \textcolor{keyword}{const}\& u, T \textcolor{keyword}{const}\& v) \{}
\DoxyCodeLine{331     T rootu = \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_af306ad0e3e6f9a7508d44fe13c55e3a5}{find}}(u);}
\DoxyCodeLine{332     T rootv = \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_af306ad0e3e6f9a7508d44fe13c55e3a5}{find}}(v);}
\DoxyCodeLine{333     \textcolor{keywordflow}{if} (rootu != rootv) \{}
\DoxyCodeLine{334       \textcolor{comment}{//if u, v does not belong to the same set}}
\DoxyCodeLine{335       \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a63ff23b599f3a696ff3e3dcddfe144ff}{combineByHeight}}(rootu, rootv);}
\DoxyCodeLine{336       -\/-\/this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a003da270e650bfb2b0d83fbb6daca749}{nsets\_}};}
\DoxyCodeLine{337     \}}
\DoxyCodeLine{338   \}}
\DoxyCodeLine{339 }
\DoxyCodeLine{347   \textcolor{keywordtype}{void} \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_af49a079a84612551ce66479721902042}{combineBySize}}(T \textcolor{keyword}{const}\& u, T \textcolor{keyword}{const}\& v) \{}
\DoxyCodeLine{348     \textcolor{keywordflow}{if} (0 < this-\/>sets\_[u]) std::cerr << u << \textcolor{stringliteral}{"{}u:"{}} << this-\/>sets\_[u] << std::endl;}
\DoxyCodeLine{349     \textcolor{keywordflow}{if} (0 < this-\/>sets\_[v]) \{}
\DoxyCodeLine{350       ;}
\DoxyCodeLine{351       std::cerr << v << \textcolor{stringliteral}{"{}v:"{}} << this-\/>sets\_[v] << std::endl;}
\DoxyCodeLine{352     \}}
\DoxyCodeLine{353     assert(0 >= this-\/>sets\_[u]);}
\DoxyCodeLine{354     assert(0 >= this-\/>sets\_[v]);}
\DoxyCodeLine{355     \textcolor{keywordflow}{if} (this-\/>sets\_[u] > this-\/>sets\_[v]) \{}
\DoxyCodeLine{356       \textcolor{comment}{//remember both are negative numbers}}
\DoxyCodeLine{357       \textcolor{comment}{//merge the smaller tree u into larger tree v}}
\DoxyCodeLine{358       \textcolor{comment}{//combine the size of two merged trees}}
\DoxyCodeLine{359       this-\/>sets\_[v] += this-\/>sets\_[u];}
\DoxyCodeLine{360       \textcolor{comment}{//set the new root of u to v}}
\DoxyCodeLine{361       this-\/>sets\_[u] = v;}
\DoxyCodeLine{362     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{363       this-\/>sets\_[u] += this-\/>sets\_[v];}
\DoxyCodeLine{364       this-\/>sets\_[v] = u;}
\DoxyCodeLine{365     \}}
\DoxyCodeLine{366   \}}
\DoxyCodeLine{367   \textcolor{comment}{//TODO NOT fully tested.}}
\DoxyCodeLine{368   \textcolor{comment}{//u is always larger than v}}
\DoxyCodeLine{369   \textcolor{keywordtype}{void} unionBySizeAtomic(T u, T v) \{}
\DoxyCodeLine{370     T rootu, rootv;}
\DoxyCodeLine{371     T valueofu, valueofv;}
\DoxyCodeLine{372 }
\DoxyCodeLine{373     rootu = u;}
\DoxyCodeLine{374     rootv = \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a3b80f8dd1e1cd5e8c4830a5eca4c5b1d}{find\_with\_pathcompression}}(v);}
\DoxyCodeLine{375     \textcolor{keywordflow}{if} (rootu == rootv) \textcolor{keywordflow}{return};}
\DoxyCodeLine{376     valueofu = this-\/>sets\_[rootu];}
\DoxyCodeLine{377     valueofv = this-\/>sets\_[rootv];}
\DoxyCodeLine{378     \textcolor{comment}{//if (0 < this-\/>sets\_[rootu]) \{ continue; \}}}
\DoxyCodeLine{379     \textcolor{comment}{//if (0 < this-\/>sets\_[rootv]) \{ continue; \}}}
\DoxyCodeLine{380     \textcolor{keywordflow}{if} (valueofu > valueofv) \{}
\DoxyCodeLine{381       \textcolor{comment}{//remember both are negative numbers}}
\DoxyCodeLine{382       \textcolor{comment}{//merge the smaller tree u into larger tree v}}
\DoxyCodeLine{383       \textcolor{comment}{//combine the size of two merged trees}}
\DoxyCodeLine{384       \textcolor{comment}{//this-\/>sets\_[v] += this-\/>sets\_[u];}}
\DoxyCodeLine{385       \textcolor{comment}{//set the new root of u to v}}
\DoxyCodeLine{386       \textcolor{comment}{//this-\/>sets\_[u] = v;}}
\DoxyCodeLine{387       writeAdd(this-\/>sets\_[rootv], valueofu);}
\DoxyCodeLine{388       assert(this-\/>sets\_[rootv] < std::numeric\_limits<T>::max());}
\DoxyCodeLine{389       \textcolor{comment}{//writeMin(this-\/>sets\_[rootu], rootv, std::greater<T>());}}
\DoxyCodeLine{390       \textcolor{comment}{//assert(this-\/>sets\_[rootu] < std::numeric\_limits<T>::max());}}
\DoxyCodeLine{391       \textcolor{comment}{// large id joins small id's set}}
\DoxyCodeLine{392     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{393       \textcolor{comment}{//this-\/>sets\_[u] += this-\/>sets\_[v];}}
\DoxyCodeLine{394       \textcolor{comment}{//this-\/>sets\_[v] = u;}}
\DoxyCodeLine{395       writeAdd(this-\/>sets\_[rootu], valueofv);}
\DoxyCodeLine{396       assert(this-\/>sets\_[rootu] < std::numeric\_limits<T>::max());}
\DoxyCodeLine{397       \textcolor{comment}{//writeMin(this-\/>sets\_[rootv], rootu, std::greater<T>());}}
\DoxyCodeLine{398       \textcolor{comment}{//assert(this-\/>sets\_[rootv] < std::numeric\_limits<T>::max());}}
\DoxyCodeLine{399       \textcolor{comment}{// large id joins small id's set}}
\DoxyCodeLine{400     \}}
\DoxyCodeLine{401     \textcolor{keywordflow}{if} (u < v)}
\DoxyCodeLine{402       this-\/>sets\_[rootu] = rootv;}
\DoxyCodeLine{403     \textcolor{keywordflow}{else}}
\DoxyCodeLine{404       this-\/>sets\_[rootv] = rootu;}
\DoxyCodeLine{405     std::cout << u << \textcolor{stringliteral}{"{}v"{}} << v << \textcolor{stringliteral}{"{}:"{}} << rootu << \textcolor{stringliteral}{"{}v"{}} << rootv << \textcolor{stringliteral}{"{}:"{}} << valueofu << \textcolor{stringliteral}{"{}v"{}} << valueofv << \textcolor{stringliteral}{"{}:"{}} << this-\/>sets\_[rootu] << \textcolor{stringliteral}{"{}v"{}}}
\DoxyCodeLine{406               << this-\/>sets\_[rootv] << std::endl;}
\DoxyCodeLine{407   \}    \textcolor{comment}{//unionBySizeAtomic}}
\DoxyCodeLine{408 }
\DoxyCodeLine{414   \textcolor{keywordtype}{void} \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a63ff23b599f3a696ff3e3dcddfe144ff}{combineByHeight}}(T \textcolor{keyword}{const}\& v, T \textcolor{keyword}{const}\& u) \{}
\DoxyCodeLine{415     assert(0 >= this-\/>sets\_[u]);}
\DoxyCodeLine{416     assert(0 >= this-\/>sets\_[v]);}
\DoxyCodeLine{417     \textcolor{keywordflow}{if} (this-\/>sets\_[v] > this-\/>sets\_[u]) \{}
\DoxyCodeLine{418       \textcolor{comment}{//remember both are negative numbers}}
\DoxyCodeLine{419       \textcolor{comment}{//merge the shorter tree v into taller tree u}}
\DoxyCodeLine{420       this-\/>sets\_[v] = u;    \textcolor{comment}{//make v the new root}}
\DoxyCodeLine{421     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{422       \textcolor{comment}{//merge the shorter tree u into taller tree v}}
\DoxyCodeLine{423       \textcolor{keywordflow}{if} (this-\/>sets\_[u] == this-\/>sets\_[v]) -\/-\/this-\/>sets\_[v];    \textcolor{comment}{//update height if same}}
\DoxyCodeLine{424       this-\/>sets\_[u] = v;                                        \textcolor{comment}{//make u the new root}}
\DoxyCodeLine{425     \}}
\DoxyCodeLine{426   \}}
\DoxyCodeLine{427   \textcolor{keywordtype}{void} UnionBySplicing(T v, T u) \{}
\DoxyCodeLine{428     T z;    \textcolor{comment}{//temp variable to store element}}
\DoxyCodeLine{429     \textcolor{keywordflow}{while} (this-\/>sets\_[v] != this-\/>sets\_[u]) \{}
\DoxyCodeLine{430       \textcolor{comment}{//a lower numbered node points to a higher numbered node or itself(root)}}
\DoxyCodeLine{431       \textcolor{keywordflow}{if} (this-\/>sets\_[v] < this-\/>sets\_[u]) \{}
\DoxyCodeLine{432 }
\DoxyCodeLine{433         \textcolor{keywordflow}{if} (v == this-\/>sets\_[v]) \{}
\DoxyCodeLine{434           \textcolor{comment}{//when v is the root of current set, set v's parent as u}}
\DoxyCodeLine{435           this-\/>sets\_[v] = this-\/>sets\_[u];}
\DoxyCodeLine{436           \textcolor{keywordflow}{break};}
\DoxyCodeLine{437         \}}
\DoxyCodeLine{438         z              = v;}
\DoxyCodeLine{439         this-\/>sets\_[v] = this-\/>sets\_[u];}
\DoxyCodeLine{440         v              = this-\/>sets\_[z];}
\DoxyCodeLine{441       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{442         \textcolor{keywordflow}{if} (u == this-\/>sets\_[u]) \{}
\DoxyCodeLine{443           \textcolor{comment}{//when u the root of current set, set u's parent as u}}
\DoxyCodeLine{444           this-\/>sets\_[u] = this-\/>sets\_[v];}
\DoxyCodeLine{445           \textcolor{keywordflow}{break};}
\DoxyCodeLine{446         \}}
\DoxyCodeLine{447         z              = u;}
\DoxyCodeLine{448         this-\/>sets\_[u] = this-\/>sets\_[v];}
\DoxyCodeLine{449         u              = this-\/>sets\_[z];}
\DoxyCodeLine{450       \}}
\DoxyCodeLine{451     \}    \textcolor{comment}{//while}}
\DoxyCodeLine{452   \}      \textcolor{comment}{//UnionBySplicing}}
\DoxyCodeLine{453 }
\DoxyCodeLine{454   std::vector<T> getRawSubsets()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{455     std::vector<T> sets(this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}, 0);}
\DoxyCodeLine{456     \textcolor{keywordflow}{for} (T i = 0; i < \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}; ++i) \{}
\DoxyCodeLine{457       \textcolor{comment}{//for each entry belongs the same subset, insert the entry index into the sets[root]}}
\DoxyCodeLine{458       sets[i] = this-\/>sets\_[i];}
\DoxyCodeLine{459     \}}
\DoxyCodeLine{460     \textcolor{keywordflow}{return} sets;}
\DoxyCodeLine{461   \}}
\DoxyCodeLine{466   std::vector<std::set<T>> \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_aff9ebb950bc3fd3deede308d3f8821da}{getSubsets}}()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{467     std::vector<std::set<T>> sets(this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}} + 1);}
\DoxyCodeLine{468     \textcolor{keywordflow}{for} (T i = 0; i < \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}; ++i) \{}
\DoxyCodeLine{469       \textcolor{comment}{//for each entry belongs the same subset, insert the entry index into the sets[root]}}
\DoxyCodeLine{470       sets[\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_af306ad0e3e6f9a7508d44fe13c55e3a5}{find}}(i)].insert(i);}
\DoxyCodeLine{471     \}}
\DoxyCodeLine{472     std::vector<std::set<T>> subsets;}
\DoxyCodeLine{473     \textcolor{keywordflow}{for} (std::set<T> s : sets) \{}
\DoxyCodeLine{474       \textcolor{keywordflow}{if} (0 < s.size()) \{}
\DoxyCodeLine{475         subsets.push\_back(s);}
\DoxyCodeLine{476       \}}
\DoxyCodeLine{477     \}}
\DoxyCodeLine{478     \textcolor{keywordflow}{return} subsets;}
\DoxyCodeLine{479   \}}
\DoxyCodeLine{485   std::vector<T> \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a0f7c385f12661c2a1aedf3b719705103}{getCompactDisjSets}}(\textcolor{keywordtype}{size\_t}\& nsets)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{486     std::vector<T> compactsets(this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}, -\/1);}
\DoxyCodeLine{487     T              j = 0;}
\DoxyCodeLine{488     \textcolor{keywordflow}{for} (T i = 0; i < \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}; ++i) \{}
\DoxyCodeLine{489       \textcolor{comment}{//std::cout << this-\/>sets\_[i] << "{} "{};}}
\DoxyCodeLine{490       \textcolor{comment}{//find the root of the set and give it an artifitial label}}
\DoxyCodeLine{491       \textcolor{keywordflow}{if} (0 > sets\_[i]) \{}
\DoxyCodeLine{492         compactsets[i] = ++j;}
\DoxyCodeLine{493       \}}
\DoxyCodeLine{494     \}}
\DoxyCodeLine{495     nsets = j;}
\DoxyCodeLine{496     \textcolor{keywordflow}{for} (T i = 0; i < \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}; ++i) \{}
\DoxyCodeLine{497       \textcolor{comment}{//for every non-\/root element in the set, change its label to the artifitial label}}
\DoxyCodeLine{498       \textcolor{keywordflow}{if} (0 <= sets\_[i]) \{}
\DoxyCodeLine{499         compactsets[i] = compactsets[\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_af306ad0e3e6f9a7508d44fe13c55e3a5}{find}}(i)];}
\DoxyCodeLine{500       \}}
\DoxyCodeLine{501     \}}
\DoxyCodeLine{502     \textcolor{keywordflow}{return} compactsets;}
\DoxyCodeLine{503   \}}
\DoxyCodeLine{504 }
\DoxyCodeLine{505   std::vector<T> getCompactDisjSets()\textcolor{keyword}{ const }\{}
\DoxyCodeLine{506     T              j = 1;}
\DoxyCodeLine{507     std::vector<T> compactsets(this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}});}
\DoxyCodeLine{508     std::map<T, T> compactmap;}
\DoxyCodeLine{509     \textcolor{keywordflow}{for} (T i = 0; i < \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}; ++i) \{}
\DoxyCodeLine{510       \textcolor{keyword}{auto} result = compactmap.insert(std::make\_pair(sets\_[i], j));}
\DoxyCodeLine{511       \textcolor{keywordflow}{if} (result.second) ++j;}
\DoxyCodeLine{512     \}}
\DoxyCodeLine{513 }
\DoxyCodeLine{514     \textcolor{comment}{//\#pragma omp parallel for}}
\DoxyCodeLine{515     \textcolor{keywordflow}{for} (T i = 0; i < \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}; ++i) \{}
\DoxyCodeLine{516       compactsets[i] = compactmap[sets\_[i]];}
\DoxyCodeLine{517       \textcolor{comment}{//std::cout << i << "{}("{} << sets\_[i] << "{})"{}<< compactsets[i] << "{} "{};}}
\DoxyCodeLine{518     \}}
\DoxyCodeLine{519     \textcolor{keywordflow}{return} compactsets;}
\DoxyCodeLine{520   \}}
\DoxyCodeLine{525   \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a3eeb8516f438597b568f255360644ade}{getSetNumber}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a003da270e650bfb2b0d83fbb6daca749}{nsets\_}}; \}}
\DoxyCodeLine{531   \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a4afbc76f621adbcf606fcbf5c0da25d0}{getSetSize}}(\textcolor{keyword}{const} T u)\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} -\/\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_af306ad0e3e6f9a7508d44fe13c55e3a5}{find}}(u); \}}
\DoxyCodeLine{538   \textcolor{keyword}{friend} \textcolor{keyword}{inline} std::ostream\& \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_aec14eac365197e5187fcd7587407fa9a}{operator<<}}(std::ostream\& os, \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set}{disjoint\_set<T>}} \textcolor{keyword}{const}\& s) \{}
\DoxyCodeLine{539     s.\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_ad68830538db5c029c45984848717b6d0}{printDisjSets}}(os);}
\DoxyCodeLine{540     \textcolor{keywordflow}{return} os;}
\DoxyCodeLine{541   \}}
\DoxyCodeLine{545   \textcolor{keywordtype}{void} \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_ad68830538db5c029c45984848717b6d0}{printDisjSets}}(std::ostream\& os)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{546     \textcolor{keywordflow}{for} (T i = 0; i < this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}; ++i) \{}
\DoxyCodeLine{547       os << i << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{548     \}}
\DoxyCodeLine{549     os << std::endl;}
\DoxyCodeLine{550     \textcolor{keywordflow}{for} (T i = 0; i < this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}; ++i) \{}
\DoxyCodeLine{551       os << this-\/>sets\_[i] << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{552     \}}
\DoxyCodeLine{553     os << std::endl;}
\DoxyCodeLine{554   \}}
\DoxyCodeLine{559   T \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a09ad6ecd3e3b8cd6d9598fa1512b1624}{getMaxId}}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}; \}}
\DoxyCodeLine{560 }
\DoxyCodeLine{561 \textcolor{keyword}{private}:}
\DoxyCodeLine{562   \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} compare\_and\_swap(T\& x, T old\_val, T new\_val) \{ \textcolor{keywordflow}{return} \_\_sync\_bool\_compare\_and\_swap(\&x, *(\&old\_val), *(\&new\_val)); \}}
\DoxyCodeLine{563 }
\DoxyCodeLine{564   \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} writeMin(T\& a, T b) \{}
\DoxyCodeLine{565     T    c;}
\DoxyCodeLine{566     \textcolor{keywordtype}{bool} r = \textcolor{keyword}{false};}
\DoxyCodeLine{567     \textcolor{keywordflow}{do}}
\DoxyCodeLine{568       c = a;}
\DoxyCodeLine{569     \textcolor{keywordflow}{while} (c > b \&\& !(r = compare\_and\_swap(a, c, b)));}
\DoxyCodeLine{570     \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{571   \}}
\DoxyCodeLine{572 }
\DoxyCodeLine{573   \textcolor{keyword}{template} <\textcolor{keyword}{typename} F>}
\DoxyCodeLine{574   \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} writeMin(T\& addr, T new\_val, F less) \{}
\DoxyCodeLine{575     T    old\_val;}
\DoxyCodeLine{576     \textcolor{keywordtype}{bool} r = \textcolor{keyword}{false};}
\DoxyCodeLine{577     \textcolor{keywordflow}{do}}
\DoxyCodeLine{578       old\_val = addr;}
\DoxyCodeLine{579     \textcolor{keywordflow}{while} (less(new\_val, old\_val) \&\& !(r = compare\_and\_swap(addr, old\_val, new\_val)));}
\DoxyCodeLine{580     \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{581   \}}
\DoxyCodeLine{582 }
\DoxyCodeLine{583   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} writeAdd(T\& a, T b) \{}
\DoxyCodeLine{584     \textcolor{keyword}{volatile} T newv, oldv;}
\DoxyCodeLine{585     \textcolor{keywordflow}{do} \{}
\DoxyCodeLine{586       oldv = a;}
\DoxyCodeLine{587       newv = oldv + b;}
\DoxyCodeLine{588     \} \textcolor{keywordflow}{while} (!compare\_and\_swap(a, oldv, newv));}
\DoxyCodeLine{589   \}}
\DoxyCodeLine{590 }
\DoxyCodeLine{591 \textcolor{keyword}{public}:}
\DoxyCodeLine{592   \textcolor{keyword}{template} <\textcolor{keyword}{typename} L>}
\DoxyCodeLine{593   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} forEach(L handle)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{594     \textcolor{keywordflow}{for} (T i = 0; i < this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}; ++i)}
\DoxyCodeLine{595       handle(this-\/>sets\_[i]);}
\DoxyCodeLine{596   \}}
\DoxyCodeLine{597   \textcolor{keyword}{template} <\textcolor{keyword}{typename} L>}
\DoxyCodeLine{598   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} forEachElement(L handle)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{599     \textcolor{keywordflow}{for} (T i = 0; i < this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}; ++i)}
\DoxyCodeLine{600       handle(i);}
\DoxyCodeLine{601   \}}
\DoxyCodeLine{602   \textcolor{keyword}{template} <\textcolor{keyword}{typename} L>}
\DoxyCodeLine{603   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} forEachRoot(L handle)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{604     \textcolor{keywordflow}{for} (T i = 0; i < this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}; ++i)}
\DoxyCodeLine{605       \textcolor{comment}{//by definition, root is the element of negative height/size in disjoint\_set}}
\DoxyCodeLine{606       \textcolor{keywordflow}{if} (0 > this-\/>sets\_[i] || i == this-\/>sets\_[i]) handle(this-\/>sets\_[i]);}
\DoxyCodeLine{607   \}}
\DoxyCodeLine{608   \textcolor{keyword}{template} <\textcolor{keyword}{typename} L>}
\DoxyCodeLine{609   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} forEachRootIndex(L handle)\textcolor{keyword}{ const }\{}
\DoxyCodeLine{610     \textcolor{keywordflow}{for} (T i = 0; i < this-\/>\mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}}; ++i)}
\DoxyCodeLine{611       \textcolor{comment}{//by definition, root is the element of negative height/size in disjoint\_set}}
\DoxyCodeLine{612       \textcolor{keywordflow}{if} (0 > this-\/>sets\_[i] || i == this-\/>sets\_[i]) handle(i);}
\DoxyCodeLine{613   \}}
\DoxyCodeLine{614 }
\DoxyCodeLine{615 \textcolor{keyword}{protected}:}
\DoxyCodeLine{619   \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a003da270e650bfb2b0d83fbb6daca749}{nsets\_}};    \textcolor{comment}{//not used in parallel}}
\DoxyCodeLine{623 \textcolor{comment}{}  T  \mbox{\hyperlink{classnw_1_1graph_1_1disjoint__set_a7620864bd912d4214accf47f31bc198e}{maxid\_}};}
\DoxyCodeLine{624   T* sets\_;}
\DoxyCodeLine{625 \};    \textcolor{comment}{//class disjoint\_set}}
\DoxyCodeLine{626 }
\DoxyCodeLine{627 \}    \textcolor{comment}{// namespace graph}}
\DoxyCodeLine{628 \}    \textcolor{comment}{// namespace nw}}
\DoxyCodeLine{629 }
\DoxyCodeLine{630 \textcolor{preprocessor}{\#endif    }\textcolor{comment}{// NW\_GRAPH\_DISJOINT\_SET\_HPP}}

\end{DoxyCode}
