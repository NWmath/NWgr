\hypertarget{experimental_2algorithms_2triangle__count_8hpp_source}{}\doxysection{triangle\+\_\+count.\+hpp}
\label{experimental_2algorithms_2triangle__count_8hpp_source}\index{/Users/lums/NWmath/NWgr/include/nwgraph/experimental/algorithms/triangle\_count.hpp@{/Users/lums/NWmath/NWgr/include/nwgraph/experimental/algorithms/triangle\_count.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// }}
\DoxyCodeLine{2 \textcolor{comment}{// This file is part of NW Graph (aka GraphPack) }}
\DoxyCodeLine{3 \textcolor{comment}{// (c) Pacific Northwest National Laboratory 2018-\/2021 }}
\DoxyCodeLine{4 \textcolor{comment}{// (c) University of Washington 2018-\/2021 }}
\DoxyCodeLine{5 \textcolor{comment}{// }}
\DoxyCodeLine{6 \textcolor{comment}{// Licensed under terms of include LICENSE file }}
\DoxyCodeLine{7 \textcolor{comment}{// }}
\DoxyCodeLine{8 \textcolor{comment}{// Authors: }}
\DoxyCodeLine{9 \textcolor{comment}{//     Andrew Lumsdaine }}
\DoxyCodeLine{10 \textcolor{comment}{//     Kevin Deweese    }}
\DoxyCodeLine{11 \textcolor{comment}{//}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{preprocessor}{\#ifndef NW\_GRAPH\_TRIANGLE\_COUNT\_EXPERIMENTAL\_HPP}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#define NW\_GRAPH\_TRIANGLE\_COUNT\_EXPERIMENTAL\_HPP}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{preprocessor}{\#include "{}nwgraph/graph\_concepts.hpp"{}}}
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include "{}nwgraph/adaptors/cyclic\_range\_adapter.hpp"{}}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include "{}nwgraph/adaptors/neighbor\_range.hpp"{}}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#include "{}nwgraph/adaptors/edge\_range.hpp"{}}}
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include "{}nwgraph/util/intersection\_size.hpp"{}}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}nwgraph/util/parallel\_for.hpp"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}nwgraph/util/timer.hpp"{}}}
\DoxyCodeLine{23 \textcolor{preprocessor}{\#include "{}nwgraph/util/util.hpp"{}}}
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{preprocessor}{\#include <atomic>}}
\DoxyCodeLine{26 \textcolor{preprocessor}{\#include <future>}}
\DoxyCodeLine{27 \textcolor{preprocessor}{\#include <thread>}}
\DoxyCodeLine{28 \textcolor{preprocessor}{\#include <tuple>}}
\DoxyCodeLine{29 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{30 }
\DoxyCodeLine{31 \textcolor{keyword}{namespace }nw \{}
\DoxyCodeLine{32 \textcolor{keyword}{namespace }graph \{}
\DoxyCodeLine{33 }
\DoxyCodeLine{34 \textcolor{keyword}{template} <\textcolor{keyword}{typename} \_InputIterator1, \textcolor{keyword}{typename} \_InputIterator2, \textcolor{keyword}{typename} \_OutputIterator>}
\DoxyCodeLine{35 \_OutputIterator lower\_bound\_set\_intersection(\_InputIterator1 \_\_first1, \_InputIterator1 \_\_last1, \_InputIterator2 \_\_first2,}
\DoxyCodeLine{36                                              \_InputIterator2 \_\_last2, \_OutputIterator \_\_result) \{}
\DoxyCodeLine{37   \textcolor{keywordflow}{while} (\_\_first1 != \_\_last1 \&\& \_\_first2 != \_\_last2)}
\DoxyCodeLine{38     \textcolor{keywordflow}{if} (*\_\_first1 < *\_\_first2) \{}
\DoxyCodeLine{39       ++\_\_first1;}
\DoxyCodeLine{40       \_\_first1 = std::lower\_bound(\_\_first1, \_\_last1, *\_\_first2);}
\DoxyCodeLine{41     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (*\_\_first2 < *\_\_first1) \{}
\DoxyCodeLine{42       ++\_\_first2;}
\DoxyCodeLine{43       \_\_first2 = std::lower\_bound(\_\_first2, \_\_last2, *\_\_first1);}
\DoxyCodeLine{44     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{45       *\_\_result = *\_\_first1;}
\DoxyCodeLine{46       ++\_\_first1;}
\DoxyCodeLine{47       ++\_\_first2;}
\DoxyCodeLine{48       ++\_\_result;}
\DoxyCodeLine{49     \}}
\DoxyCodeLine{50   \textcolor{keywordflow}{return} \_\_result;}
\DoxyCodeLine{51 \}}
\DoxyCodeLine{52 }
\DoxyCodeLine{53 \textcolor{keyword}{template} <adjacency\_list\_graph GraphT>}
\DoxyCodeLine{54 \textcolor{keywordtype}{size\_t} triangle\_count\_vc(\textcolor{keyword}{const} GraphT\& A) \{}
\DoxyCodeLine{55   \textcolor{keywordtype}{size\_t}                   triangles = 0;}
\DoxyCodeLine{56   counting\_output\_iterator counter(triangles);}
\DoxyCodeLine{57 }
\DoxyCodeLine{58   \textcolor{keywordtype}{size\_t} len  = A.indices\_.size() -\/ 1;}
\DoxyCodeLine{59   \textcolor{keyword}{auto}   ptrs = A.indices\_;}
\DoxyCodeLine{60   \textcolor{keyword}{auto}   idxs = std::get<0>(A.to\_be\_indexed\_);}
\DoxyCodeLine{61 }
\DoxyCodeLine{62   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < len; ++i) \{}
\DoxyCodeLine{63     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} j = ptrs[i]; j < ptrs[i + 1]; ++j) \{}
\DoxyCodeLine{64       \textcolor{keywordtype}{size\_t} k  = idxs[j];}
\DoxyCodeLine{65       \textcolor{keywordtype}{size\_t} k0 = ptrs[i];}
\DoxyCodeLine{66       \textcolor{keywordtype}{size\_t} k1 = ptrs[i + 1];}
\DoxyCodeLine{67       \textcolor{keywordtype}{size\_t} k2 = ptrs[k];}
\DoxyCodeLine{68       \textcolor{keywordtype}{size\_t} k3 = ptrs[k + 1];}
\DoxyCodeLine{69 }
\DoxyCodeLine{70       lower\_bound\_set\_intersection(\&idxs[k2], \&idxs[k3], \&idxs[k0], \&idxs[k1], counter);}
\DoxyCodeLine{71     \}}
\DoxyCodeLine{72   \}}
\DoxyCodeLine{73 }
\DoxyCodeLine{74   \textcolor{keywordflow}{return} triangles;}
\DoxyCodeLine{75 \}}
\DoxyCodeLine{76 }
\DoxyCodeLine{77 }
\DoxyCodeLine{78 \textcolor{keyword}{template} <adjacency\_list\_graph GraphT>}
\DoxyCodeLine{79 \textcolor{keywordtype}{size\_t} triangle\_count\_v1(\textcolor{keyword}{const} GraphT\& A) \{}
\DoxyCodeLine{80   \textcolor{keywordtype}{size\_t} triangles = 0;}
\DoxyCodeLine{81   \textcolor{keyword}{auto}   first     = A.begin();}
\DoxyCodeLine{82   \textcolor{keyword}{auto}   last      = A.end();}
\DoxyCodeLine{83 }
\DoxyCodeLine{84   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} G = first; first != last; ++first) \{}
\DoxyCodeLine{85     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} elt = (*first).begin(); elt != (*first).end(); ++elt) \{}
\DoxyCodeLine{86       \textcolor{keyword}{auto} v = target(A, *elt);}
\DoxyCodeLine{87       triangles += nw::graph::intersection\_size(elt, (*first).end(), G[v]);}
\DoxyCodeLine{88     \}}
\DoxyCodeLine{89   \}}
\DoxyCodeLine{90   \textcolor{keywordflow}{return} triangles;}
\DoxyCodeLine{91 \}}
\DoxyCodeLine{92 }
\DoxyCodeLine{93 \textcolor{keyword}{template} <adjacency\_list\_graph GraphT>}
\DoxyCodeLine{94 \textcolor{keywordtype}{size\_t} triangle\_count\_v15(\textcolor{keyword}{const} GraphT\& A) \{}
\DoxyCodeLine{95   \textcolor{keywordtype}{size\_t} triangles = 0;}
\DoxyCodeLine{96 }
\DoxyCodeLine{97   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\&\& [u, u\_neighbors] : make\_neighbor\_range(A)) \{}
\DoxyCodeLine{98     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\&\& elt : u\_neighbors) \{}
\DoxyCodeLine{99       \textcolor{keyword}{auto} v = target(A, elt);}
\DoxyCodeLine{100       triangles += nw::graph::intersection\_size(u\_neighbors, A[v]);}
\DoxyCodeLine{101     \}}
\DoxyCodeLine{102   \}}
\DoxyCodeLine{103   \textcolor{keywordflow}{return} triangles;}
\DoxyCodeLine{104 \}}
\DoxyCodeLine{105 }
\DoxyCodeLine{106 \textcolor{comment}{//****************************************************************************}}
\DoxyCodeLine{107 \textcolor{comment}{// Should this work?}}
\DoxyCodeLine{108 \textcolor{keyword}{template} <adjacency\_list\_graph GraphT>}
\DoxyCodeLine{109 \textcolor{keywordtype}{size\_t} triangle\_count\_v2(\textcolor{keyword}{const} GraphT\& A) \{}
\DoxyCodeLine{110   \textcolor{keywordtype}{size\_t} triangles = 0;}
\DoxyCodeLine{111   \textcolor{keywordtype}{size\_t} i         = 0;}
\DoxyCodeLine{112   \textcolor{keyword}{auto}   G         = A.begin();}
\DoxyCodeLine{113 }
\DoxyCodeLine{114   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\&\& node : A) \{}
\DoxyCodeLine{115     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\&\& elt : node) \{}
\DoxyCodeLine{116       \textcolor{keyword}{auto} u = target(A, elt);}
\DoxyCodeLine{117       triangles += nw::graph::intersection\_size(G[u], G[i]);}
\DoxyCodeLine{118     \}}
\DoxyCodeLine{119     ++i;}
\DoxyCodeLine{120   \}}
\DoxyCodeLine{121   \textcolor{keywordflow}{return} triangles;}
\DoxyCodeLine{122 \}}
\DoxyCodeLine{123 }
\DoxyCodeLine{124 \textcolor{comment}{//****************************************************************************}}
\DoxyCodeLine{125 \textcolor{keyword}{template} <\textcolor{keyword}{class} Graph>}
\DoxyCodeLine{126 \textcolor{keywordtype}{size\_t} triangle\_count\_v3(\textcolor{keyword}{const} Graph\& A) \{}
\DoxyCodeLine{127   \textcolor{keywordtype}{size\_t} triangles = 0;}
\DoxyCodeLine{128   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\&\& [v, u] : make\_edge\_range(A)) \{}
\DoxyCodeLine{129     triangles += nw::graph::intersection\_size(A[v], A[u]);}
\DoxyCodeLine{130   \}}
\DoxyCodeLine{131   \textcolor{keywordflow}{return} triangles;}
\DoxyCodeLine{132 \}}
\DoxyCodeLine{133 }
\DoxyCodeLine{134 }
\DoxyCodeLine{149 \textcolor{keyword}{template} <\textcolor{keyword}{typename} RandomAccessIterator>}
\DoxyCodeLine{150 [[gnu::noinline]] std::size\_t triangle\_count\_v5(RandomAccessIterator first, RandomAccessIterator last, std::size\_t threads = 1) \{}
\DoxyCodeLine{151   \textcolor{keywordflow}{return} triangle\_count\_async(threads, [\&](std::size\_t tid) \{}
\DoxyCodeLine{152     std::size\_t triangles = 0;}
\DoxyCodeLine{153     \textcolor{keyword}{auto}\&\& [u, ue]        = nw::graph::block(last -\/ first, threads, tid);}
\DoxyCodeLine{154     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} i = first + u, end = first + ue; i != end; ++i) \{}
\DoxyCodeLine{155       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} j = (*i).begin(), end = (*i).end(); j != end; ++j) \{}
\DoxyCodeLine{156         triangles += nw::graph::intersection\_size(j, end, first[std::get<0>(*j)]);}
\DoxyCodeLine{157       \}}
\DoxyCodeLine{158     \}}
\DoxyCodeLine{159     \textcolor{keywordflow}{return} triangles;}
\DoxyCodeLine{160   \});}
\DoxyCodeLine{161 \}}
\DoxyCodeLine{162 }
\DoxyCodeLine{176 \textcolor{keyword}{template} <\textcolor{keyword}{typename} RandomAccessIterator>}
\DoxyCodeLine{177 [[gnu::noinline]] std::size\_t triangle\_count\_v6(RandomAccessIterator first, RandomAccessIterator last, std::size\_t threads = 1) \{}
\DoxyCodeLine{178   \textcolor{keywordflow}{return} triangle\_count\_async(threads, [\&](std::size\_t tid) \{}
\DoxyCodeLine{179     std::size\_t triangles = 0;}
\DoxyCodeLine{180     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\&\& i = first + tid; i < last; i += threads) \{}
\DoxyCodeLine{181       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\&\& [j] : *i) \{}
\DoxyCodeLine{182         triangles += nw::graph::intersection\_size(*i, first[j]);}
\DoxyCodeLine{183       \}}
\DoxyCodeLine{184     \}}
\DoxyCodeLine{185     \textcolor{keywordflow}{return} triangles;}
\DoxyCodeLine{186   \});}
\DoxyCodeLine{187 \}}
\DoxyCodeLine{188 }
\DoxyCodeLine{211 \textcolor{keyword}{template} <adjacency\_list\_graph Graph, \textcolor{keyword}{class }OuterExecutionPolicy = std::execution::parallel\_unsequenced\_policy,}
\DoxyCodeLine{212           \textcolor{keyword}{class }InnerExecutionPolicy = std::execution::sequenced\_policy>}
\DoxyCodeLine{213 [[gnu::noinline]] std::size\_t triangle\_count\_v7(\textcolor{keyword}{const} Graph\& A, OuterExecutionPolicy\&\& outer = \{\}, InnerExecutionPolicy inner = \{\}) \{}
\DoxyCodeLine{214   std::atomic<std::size\_t> total\_triangles = 0;}
\DoxyCodeLine{215   std::for\_each(outer, A.begin(), A.end(), [\&](\textcolor{keyword}{auto}\&\& x) \{}
\DoxyCodeLine{216     std::size\_t triangles = 0;}
\DoxyCodeLine{217     for (auto \&\&i = x.begin(), e = x.end(); i != e; ++i) \{}
\DoxyCodeLine{218       triangles += nw::graph::intersection\_size(i, e, A[std::get<0>(*i)], inner);}
\DoxyCodeLine{219     \}}
\DoxyCodeLine{220     total\_triangles += triangles;}
\DoxyCodeLine{221   \});}
\DoxyCodeLine{222   \textcolor{keywordflow}{return} total\_triangles;}
\DoxyCodeLine{223 \}}
\DoxyCodeLine{224 }
\DoxyCodeLine{246 \textcolor{keyword}{template} <adjacency\_list\_graph Graph, \textcolor{keyword}{class }OuterExecutionPolicy = std::execution::parallel\_unsequenced\_policy,}
\DoxyCodeLine{247           \textcolor{keyword}{class }InnerExecutionPolicy = std::execution::parallel\_policy, \textcolor{keyword}{class }SetExecutionPolicy = std::execution::sequenced\_policy>}
\DoxyCodeLine{248 [[gnu::noinline]] std::size\_t triangle\_count\_v10(\textcolor{keyword}{const} Graph\& A, OuterExecutionPolicy\&\& outer = \{\}, InnerExecutionPolicy\&\& inner = \{\},}
\DoxyCodeLine{249                                                  SetExecutionPolicy\&\& set = \{\}) \{}
\DoxyCodeLine{250   std::atomic<std::size\_t> total\_triangles = 0;}
\DoxyCodeLine{251   std::for\_each(outer, A.begin(), A.end(), [\&](\textcolor{keyword}{auto}\&\& x) \{}
\DoxyCodeLine{252     std::atomic<std::size\_t> triangles = 0;}
\DoxyCodeLine{253     std::for\_each(inner, x.begin(), x.end(), [\&](auto\&\& v) \{ triangles += nw::graph::intersection\_size(x, A[std::get<0>(v)], set); \});}
\DoxyCodeLine{254     total\_triangles += triangles;}
\DoxyCodeLine{255   \});}
\DoxyCodeLine{256   \textcolor{keywordflow}{return} total\_triangles;}
\DoxyCodeLine{257 \}}
\DoxyCodeLine{258 }
\DoxyCodeLine{277 \textcolor{keyword}{template} <adjacency\_list\_graph Graph, \textcolor{keyword}{class} SetExecutionPolicy = std::execution::sequenced\_policy>}
\DoxyCodeLine{278 [[gnu::noinline]] std::size\_t triangle\_count\_v12(\textcolor{keyword}{const} Graph\& graph, \textcolor{keywordtype}{int} stride, SetExecutionPolicy\&\& set = \{\}) \{}
\DoxyCodeLine{279   \textcolor{keywordflow}{return} nw::graph::parallel\_reduce(}
\DoxyCodeLine{280       nw::graph::cyclic(graph, stride),}
\DoxyCodeLine{281       [\&](\textcolor{keyword}{auto}\&\& i) \{}
\DoxyCodeLine{282         std::size\_t triangles = 0;}
\DoxyCodeLine{283         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&\&j = i.begin(), e = i.end(); j != e; ++j) \{}
\DoxyCodeLine{284           triangles += nw::graph::intersection\_size(j, e, graph[std::get<0>(*j)], set);}
\DoxyCodeLine{285         \}}
\DoxyCodeLine{286         \textcolor{keywordflow}{return} triangles;}
\DoxyCodeLine{287       \},}
\DoxyCodeLine{288       std::plus\{\}, 0.0);}
\DoxyCodeLine{289 \}}
\DoxyCodeLine{290 }
\DoxyCodeLine{310 \textcolor{keyword}{template} <adjacency\_list\_graph Graph, \textcolor{keyword}{class} SetExecutionPolicy = std::execution::sequenced\_policy>}
\DoxyCodeLine{311 [[gnu::noinline]] std::size\_t triangle\_count\_v13(\textcolor{keyword}{const} Graph\& graph, \textcolor{keywordtype}{int} stride, SetExecutionPolicy\&\& set = \{\}) \{}
\DoxyCodeLine{312   \textcolor{keywordflow}{return} nw::graph::parallel\_reduce(}
\DoxyCodeLine{313       nw::graph::cyclic(graph, stride),}
\DoxyCodeLine{314       [\&](\textcolor{keyword}{auto}\&\& i) \{}
\DoxyCodeLine{315         std::size\_t triangles = 0;}
\DoxyCodeLine{316         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\&\& elt : i) \{}
\DoxyCodeLine{317           \textcolor{keyword}{auto} j = target(graph, elt);}
\DoxyCodeLine{318           triangles += nw::graph::intersection\_size(i, graph[j], set);}
\DoxyCodeLine{319         \}}
\DoxyCodeLine{320         \textcolor{keywordflow}{return} triangles;}
\DoxyCodeLine{321       \},}
\DoxyCodeLine{322       std::plus\{\}, 0.0);}
\DoxyCodeLine{323 \}}
\DoxyCodeLine{324 }
\DoxyCodeLine{344 \textcolor{keyword}{template} <adjacency\_list\_graph Graph, \textcolor{keyword}{class} SetExecutionPolicy = std::execution::sequenced\_policy>}
\DoxyCodeLine{345 [[gnu::noinline]] std::size\_t triangle\_count\_v14(\textcolor{keyword}{const} Graph\& graph, SetExecutionPolicy\&\& set = \{\}) \{}
\DoxyCodeLine{346   \textcolor{keywordflow}{return} nw::graph::parallel\_reduce(}
\DoxyCodeLine{347       make\_edge\_range(graph), [\&](\textcolor{keyword}{auto}\&\& u, \textcolor{keyword}{auto}\&\& v) \{ \textcolor{keywordflow}{return} nw::graph::intersection\_size(graph[u], graph[v], set); \}, std::plus\{\}, 0ul);}
\DoxyCodeLine{348 \}}
\DoxyCodeLine{349 }
\DoxyCodeLine{350 \textcolor{preprocessor}{\#ifdef ONE\_DIMENSIONAL\_EDGE}}
\DoxyCodeLine{364 \textcolor{keyword}{template} <\textcolor{keyword}{class} Graph, \textcolor{keyword}{class} SetExecutionPolicy = std::execution::sequenced\_policy>}
\DoxyCodeLine{365 [[gnu::noinline]] std::size\_t triangle\_count\_edgerange(\textcolor{keyword}{const} Graph\& graph, SetExecutionPolicy\&\& set = \{\}) \{}
\DoxyCodeLine{366   \textcolor{keywordflow}{return} nw::graph::parallel\_for(}
\DoxyCodeLine{367       graph.edges(nw::graph::pow2(20)), [\&](\textcolor{keyword}{auto}\&\& u, \textcolor{keyword}{auto}\&\& v) \{ return nw::graph::intersection\_size(graph[u], graph[v], set); \}, std::plus\{\},}
\DoxyCodeLine{368       0ul);}
\DoxyCodeLine{369 \}}
\DoxyCodeLine{370 }
\DoxyCodeLine{386 \textcolor{keyword}{template} <\textcolor{keyword}{class} Graph, \textcolor{keyword}{class} SetExecutionPolicy = std::execution::sequenced\_policy>}
\DoxyCodeLine{387 [[gnu::noinline]] std::size\_t triangle\_count\_edgerange\_cyclic(\textcolor{keyword}{const} Graph\& graph, \textcolor{keywordtype}{int} stride, SetExecutionPolicy\&\& set = \{\}) \{}
\DoxyCodeLine{388   \textcolor{keywordflow}{return} nw::graph::parallel\_for(}
\DoxyCodeLine{389       nw::graph::cyclic(graph.edges(), stride), [\&](\textcolor{keyword}{auto}\&\& u, \textcolor{keyword}{auto}\&\& v) \{ return nw::graph::intersection\_size(graph[u], graph[v], set); \},}
\DoxyCodeLine{390       std::plus\{\}, 0ul);}
\DoxyCodeLine{391 \}}
\DoxyCodeLine{392 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{393 }
\DoxyCodeLine{410 \textcolor{keyword}{template} <adjacency\_list\_graph Graph>}
\DoxyCodeLine{411 [[gnu::noinline]] std::size\_t triangle\_count\_edgesplit\_upper(\textcolor{keyword}{const} Graph\& graph, std::size\_t threads = 1) \{}
\DoxyCodeLine{412   \textcolor{keywordflow}{return} triangle\_count\_async(threads, [\&](std::size\_t tid) \{}
\DoxyCodeLine{413     std::size\_t triangles = 0;}
\DoxyCodeLine{414     \textcolor{keyword}{auto}\&\& [v, ve]        = nw::graph::block(graph.to\_be\_indexed\_.size(), threads, tid);}
\DoxyCodeLine{415     \mbox{\hyperlink{classnw_1_1util_1_1life__timer}{nw::util::life\_timer}} \_(std::to\_string(tid) + \textcolor{stringliteral}{"{} "{}} + std::to\_string(graph.source(ve) -\/ graph.source(v)));}
\DoxyCodeLine{416     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&\&u = graph.source(v), e = graph.source(ve); u != e; ++u) \{}
\DoxyCodeLine{417       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&\&j = graph[u].begin(), end = graph[u].end(); j != end; ++j) \{}
\DoxyCodeLine{418         triangles += nw::graph::intersection\_size(j, end, graph[std::get<0>(*j)]);}
\DoxyCodeLine{419       \}}
\DoxyCodeLine{420     \}}
\DoxyCodeLine{421     \textcolor{keywordflow}{return} triangles;}
\DoxyCodeLine{422   \});}
\DoxyCodeLine{423 \}}
\DoxyCodeLine{424 }
\DoxyCodeLine{425 \textcolor{keyword}{template} <adjacency\_list\_graph Graph>}
\DoxyCodeLine{426 [[gnu::noinline]] std::size\_t triangle\_count\_edgesplit(\textcolor{keyword}{const} Graph\& graph, std::size\_t threads = 1) \{}
\DoxyCodeLine{427   \textcolor{keywordflow}{return} triangle\_count\_async(threads, [\&](std::size\_t tid) \{}
\DoxyCodeLine{428     std::size\_t triangles = 0;}
\DoxyCodeLine{429     \textcolor{keyword}{auto}\&\& [v, ve]        = nw::graph::block(graph.to\_be\_indexed\_.size(), threads, tid);}
\DoxyCodeLine{430     \mbox{\hyperlink{classnw_1_1util_1_1life__timer}{nw::util::life\_timer}} \_(std::to\_string(tid) + \textcolor{stringliteral}{"{} "{}} + std::to\_string(graph.source(ve) -\/ graph.source(v)));}
\DoxyCodeLine{431     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&\&u = graph.source(v), e = graph.source(ve); u != e; ++u) \{}
\DoxyCodeLine{432       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\&\& elt : graph[u]) \{}
\DoxyCodeLine{433         \textcolor{keyword}{auto} v = target(graph, elt);}
\DoxyCodeLine{434         triangles += nw::graph::intersection\_size(graph[u], graph[v]);}
\DoxyCodeLine{435       \}}
\DoxyCodeLine{436     \}}
\DoxyCodeLine{437     \textcolor{keywordflow}{return} triangles;}
\DoxyCodeLine{438   \});}
\DoxyCodeLine{439 \}}
\DoxyCodeLine{440 \}    \textcolor{comment}{// namespace graph}}
\DoxyCodeLine{441 \}    \textcolor{comment}{// namespace nw}}
\DoxyCodeLine{442 }
\DoxyCodeLine{443 \textcolor{preprocessor}{\#endif    }\textcolor{comment}{//  NW\_GRAPH\_TRIANGLE\_COUNT\_EXPERIMENTAL\_HPP}}

\end{DoxyCode}
