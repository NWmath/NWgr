\hypertarget{dag__based__mis_8hpp_source}{}\doxysection{dag\+\_\+based\+\_\+mis.\+hpp}
\label{dag__based__mis_8hpp_source}\index{/Users/lums/NWmath/NWgr/include/nwgraph/algorithms/dag\_based\_mis.hpp@{/Users/lums/NWmath/NWgr/include/nwgraph/algorithms/dag\_based\_mis.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{// }}
\DoxyCodeLine{2 \textcolor{comment}{// This file is part of NW Graph (aka GraphPack) }}
\DoxyCodeLine{3 \textcolor{comment}{// (c) Pacific Northwest National Laboratory 2018-\/2021 }}
\DoxyCodeLine{4 \textcolor{comment}{// (c) University of Washington 2018-\/2021 }}
\DoxyCodeLine{5 \textcolor{comment}{// }}
\DoxyCodeLine{6 \textcolor{comment}{// Licensed under terms of include LICENSE file }}
\DoxyCodeLine{7 \textcolor{comment}{// }}
\DoxyCodeLine{8 \textcolor{comment}{// Authors: }}
\DoxyCodeLine{9 \textcolor{comment}{//     Andrew Lumsdaine }}
\DoxyCodeLine{10 \textcolor{comment}{//     Kevin Deweese    }}
\DoxyCodeLine{11 \textcolor{comment}{//}}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{comment}{/*Implements DAG-\/adapter based MIS algorithm */}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#ifndef DAG\_BASED\_MIS\_HPP}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#define DAG\_BASED\_MIS\_HPP}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{19 }
\DoxyCodeLine{20 \textcolor{preprocessor}{\#include "{}nwgraph/adaptors/dag\_range.hpp"{}}}
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include "{}nwgraph/adaptors/edge\_range.hpp"{}}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}nwgraph/adaptors/plain\_range.hpp"{}}}
\DoxyCodeLine{23 }
\DoxyCodeLine{24 }
\DoxyCodeLine{25 \textcolor{keyword}{namespace }nw \{}
\DoxyCodeLine{26 \textcolor{keyword}{namespace }graph \{}
\DoxyCodeLine{27 }
\DoxyCodeLine{28 \textcolor{keyword}{template} <adjacency\_list\_graph Graph>}
\DoxyCodeLine{29 \textcolor{keywordtype}{void} dag\_based\_mis(Graph\& A, std::vector<bool>\& mis) \{}
\DoxyCodeLine{30   \textcolor{keywordtype}{size\_t} N = A.size();}
\DoxyCodeLine{31 \textcolor{preprocessor}{\#ifdef PRINT\_DEBUG}}
\DoxyCodeLine{32   std::cout << \textcolor{stringliteral}{"{}size: "{}} << N << std::endl;}
\DoxyCodeLine{33 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{34 }
\DoxyCodeLine{35   std::vector<size\_t> degrees(N, 0);}
\DoxyCodeLine{36   \textcolor{comment}{// std::vector<size\_t> colors(N, std::numeric\_limits<std::uint32\_t>::max());}}
\DoxyCodeLine{37 }
\DoxyCodeLine{38   std::vector<std::vector<size\_t>> predecessor\_list(N);}
\DoxyCodeLine{39   std::vector<std::vector<size\_t>> successor\_list(N);}
\DoxyCodeLine{40   std::vector<size\_t>              degree\_list(N, 0);}
\DoxyCodeLine{41   \textcolor{comment}{/*Need a "{}Degree range"{}*/}}
\DoxyCodeLine{42   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\&\& [v, deg] : plain\_degree\_range(A)) \{}
\DoxyCodeLine{43 \textcolor{preprocessor}{\#ifdef PRINT\_DEBUG}}
\DoxyCodeLine{44     std::cout << \textcolor{stringliteral}{"{}v: "{}} << v + 1 << \textcolor{stringliteral}{"{} deg: "{}} << deg << std::endl;}
\DoxyCodeLine{45 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{46     degrees[v] = deg;}
\DoxyCodeLine{47   \}}
\DoxyCodeLine{48 }
\DoxyCodeLine{49   \textcolor{comment}{/*plain edge range will be used to calculate predecessor/successors*/}}
\DoxyCodeLine{50   \textcolor{comment}{/*edge\_range returns a tuple every time iterated through*/}}
\DoxyCodeLine{51 }
\DoxyCodeLine{52   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\&\& [v, u] : edge\_range(A)) \{}
\DoxyCodeLine{53     \textcolor{keywordflow}{if} (degrees[v] > degrees[u]) \{}
\DoxyCodeLine{54       successor\_list[v].push\_back(u);}
\DoxyCodeLine{55       predecessor\_list[u].push\_back(v);}
\DoxyCodeLine{56     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (degrees[v] < degrees[u]) \{}
\DoxyCodeLine{57       predecessor\_list[v].push\_back(u);}
\DoxyCodeLine{58       successor\_list[u].push\_back(v);}
\DoxyCodeLine{59     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{60       \textcolor{keywordflow}{if} (v > u) \{}
\DoxyCodeLine{61         predecessor\_list[v].push\_back(u);}
\DoxyCodeLine{62         successor\_list[u].push\_back(v);}
\DoxyCodeLine{63       \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{64         successor\_list[v].push\_back(u);}
\DoxyCodeLine{65         predecessor\_list[u].push\_back(v);}
\DoxyCodeLine{66       \}}
\DoxyCodeLine{67     \}}
\DoxyCodeLine{68   \}}
\DoxyCodeLine{69 }
\DoxyCodeLine{70   \textcolor{keywordflow}{for} (uint64\_t vtx = 0; vtx < N; vtx++) \{}
\DoxyCodeLine{71     \textcolor{comment}{/*Set the color of the roots to be zero.*/}}
\DoxyCodeLine{72     \textcolor{keywordflow}{if} (predecessor\_list[vtx].size() == 0) \{}
\DoxyCodeLine{73       mis[vtx] = \textcolor{keyword}{true};}
\DoxyCodeLine{74 \textcolor{preprocessor}{\#ifdef PRINT\_DEBUG}}
\DoxyCodeLine{75       std::cout << vtx + 1 << \textcolor{stringliteral}{"{} is in mis: "{}} << mis[vtx] << std::endl;}
\DoxyCodeLine{76 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{77     \}}
\DoxyCodeLine{78   \}}
\DoxyCodeLine{79 }
\DoxyCodeLine{80   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto}\&\& [v, u, ready\_to\_process] : dag\_range(A, predecessor\_list, successor\_list)) \{}
\DoxyCodeLine{81 \textcolor{preprocessor}{\#ifdef PRINT\_DEBUG}}
\DoxyCodeLine{82     std::cout << \textcolor{stringliteral}{"{}V: "{}} << v + 1 << \textcolor{stringliteral}{"{} U:"{}} << u + 1 << std::endl;}
\DoxyCodeLine{83 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{84     \textcolor{keywordflow}{if} (mis[v] == \textcolor{keyword}{true}) mis[u] = \textcolor{keyword}{false};}
\DoxyCodeLine{85   \}}
\DoxyCodeLine{86 }
\DoxyCodeLine{87   \textcolor{keywordflow}{return};}
\DoxyCodeLine{88 \}}
\DoxyCodeLine{89 }
\DoxyCodeLine{90 \}    \textcolor{comment}{// namespace graph}}
\DoxyCodeLine{91 \}    \textcolor{comment}{// namespace nw}}
\DoxyCodeLine{92 \textcolor{preprocessor}{\#endif    }\textcolor{comment}{// DAG\_BASED\_MIS\_HPP}}

\end{DoxyCode}
